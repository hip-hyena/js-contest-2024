(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function s(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(n){if(n.ep)return;n.ep=!0;const i=s(n);fetch(n.href,i)}})();const Ur="modulepreload",Wr=function(t,e){return new URL(t,e).href},ds={},V=function(e,s,r){let n=Promise.resolve();if(s&&s.length>0){const i=document.getElementsByTagName("link");n=Promise.all(s.map(o=>{if(o=Wr(o,r),o in ds)return;ds[o]=!0;const a=o.endsWith(".css"),c=a?'[rel="stylesheet"]':"";if(!!r)for(let d=i.length-1;d>=0;d--){const f=i[d];if(f.href===o&&(!a||f.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${o}"]${c}`))return;const l=document.createElement("link");if(l.rel=a?"stylesheet":Ur,a||(l.as="script",l.crossOrigin=""),l.href=o,document.head.appendChild(l),a)return new Promise((d,f)=>{l.addEventListener("load",d),l.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${o}`)))})}))}return n.then(()=>e()).catch(i=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=i,window.dispatchEvent(o),!o.defaultPrevented)throw i})},fs=["web.telegram.org","webk.telegram.org"],Uo="pattern",gs=Math.min(4,navigator.hardwareConcurrency??4),B={id:1025907,hash:"452b0359b988148995f22ff0f4229750",version:"2.0.0",versionFull:"2.0.0 (500)",build:500,langPackVersion:"3.9.9",langPack:"webk",langPackCode:"en",domains:fs,baseDcId:2,isMainDomain:fs.includes(location.hostname),suffix:"K",threads:gs,cryptoWorkers:gs};B.isMainDomain&&(B.id=2496,B.hash="8da85b0d5bfe62527e5b244c209159c3");function Vr(){return document.activeElement?.blur?(document.activeElement.blur(),!0):!1}function ms(t){if(t||(t=window.event),t){t=t.originalEvent||t;try{t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault(),t.returnValue=!1,t.cancelBubble=!0}catch{}}return!1}const ue="ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch,Xt=typeof window<"u"?window:self,Pe=navigator?navigator.userAgent:null,Ot=navigator.userAgent.search(/OS X|iPhone|iPad|iOS/i)!==-1,Ns=navigator.userAgent.toLowerCase().indexOf("android")!==-1,Us=/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor),Ws=(()=>{try{return+navigator.userAgent.match(/Chrom(?:e|ium)\/(.+?)(?:\s|\.)/)[1]}catch{}})(),Ce=(/iPad|iPhone|iPod/.test(navigator.platform)||navigator.platform==="MacIntel"&&navigator.maxTouchPoints>1)&&!Xt.MSStream,q="safari"in Xt||!!(Pe&&(/\b(iPad|iPhone|iPod)\b/.test(Pe)||Pe.match("Safari")&&!Pe.match("Chrome"))),le=navigator.userAgent.toLowerCase().indexOf("firefox")>-1,Zt=q&&Ce,ee=(navigator.maxTouchPoints===void 0||navigator.maxTouchPoints>0)&&navigator.userAgent.search(/iOS|iPhone OS|Android|BlackBerry|BB10|Series ?[64]0|J2ME|MIDP|opera mini|opera mobi|mobi.+Gecko|Windows Phone/i)!=-1,jr=Object.freeze(Object.defineProperty({__proto__:null,CHROMIUM_VERSION:Ws,IS_ANDROID:Ns,IS_APPLE:Ot,IS_APPLE_MOBILE:Ce,IS_CHROMIUM:Us,IS_FIREFOX:le,IS_MOBILE:ee,IS_MOBILE_SAFARI:Zt,IS_SAFARI:q,USER_AGENT:Pe},Symbol.toStringTag,{value:"Module"}));function Yr(t,e){return t.closest("."+e)}let be;function xt(t){be?be.push(t):(be=[t],requestAnimationFrame(()=>{const e=be;be=void 0,e.forEach(s=>s())}))}let pe,Et=!1;function Wo(t){pe?Et?t():pe.push(t):(pe=[t],requestAnimationFrame(()=>{Et=!0;for(let e=0;e<pe.length;++e)pe[e]();pe=void 0,Et=!1}))}let Fe;function Vo(){return Fe||(Fe=new Promise(t=>xt(()=>t())),Fe.then(()=>{Fe=void 0}),Fe)}function Gr(){return new Promise(t=>{xt(()=>{xt(t)})})}function Ds(t){t.style.transform="translateY(-99999px)",t.focus(),Gr().then(()=>{t.style.transform=""})}const qe=q&&ee&&ue&&!1;if(qe){const t="clientY";let e=0;const s={capture:!0,passive:!1},r=i=>{const o=i.touches[0],a=Yr(o.target,"scrollable-y");if(a){const c=o[t],u=e-c,l=a.scrollTop,d=a.scrollHeight,f=a.clientHeight,m=l?Math.round(l+a.clientHeight+u):l+u;(d===f||m>=d||m<=0)&&i.preventDefault()}else i.preventDefault()};let n=0;document.addEventListener("focusin",i=>{!i.target.classList.contains("is-sticky-input-bugged")||i.timeStamp-n<50||(Ds(i.target),document.addEventListener("touchmove",r,s),document.addEventListener("touchstart",o=>{if(o.touches.length>1)return;e=o.touches[0][t]}))},{passive:!0}),document.addEventListener("focusout",i=>{document.removeEventListener("touchmove",r,s),n=i.timeStamp},{passive:!0}),document.addEventListener("visibilitychange",()=>{document.activeElement&&document.activeElement.classList.contains("is-sticky-input-bugged")&&document.activeElement.blur&&Ds(document.activeElement)},{passive:!0})}function jo(t){qe&&t.classList.add("is-sticky-input-bugged")}const Vs="Roboto",zr=Vs+', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen-Sans, Ubuntu, Cantarell, "Helvetica Neue", sans-serif',Hr="16px",$r="400",Yo=`${$r} ${Hr} ${zr}`;function Ke(){}function Qt(t){return new Promise(e=>{setTimeout(e,t)})}const js="tgico";function Go(t){return js+"-"+t}const vt=["b","Ð±"],yt={},qr={text:Vs,icons:js,monospace:"Roboto Mono"};function Kr(t={text:vt,icons:void 0,monospace:vt}){if(!("fonts"in document))return Promise.resolve();const e=[];for(const s in t){let r=t[s];r==="all"&&(r=vt);const n=qr[s],i=s==="icons"?[500]:[400,500];for(const o of i){const a=(r||[void 0]).map(c=>{var d,f;const u=[o,"1rem",n].join(" ");return(d=yt[u]??(yt[u]={}))[f=c||""]??(d[f]=document.fonts.load(u,c))});e.push(...a)}}return Promise.race([Promise.all(e).catch(Ke),Qt(1e3)])}const Bt=navigator.userAgent.search(/OS X|iPhone|iPad|iOS/i)!==-1;function Ys(t){return t instanceof URL||(t=new URL(t+"",location.href)),location.search&&t.protocol!=="blob:"&&new URLSearchParams(location.search).forEach((s,r)=>{t.searchParams.set(r,s)}),t.searchParams.delete("swfix"),t}function Jr(){const t={construct(e,s){return s[0]=Ys(s[0]),new e(...s)}};[Worker,typeof SharedWorker<"u"&&SharedWorker].filter(Boolean).forEach(e=>{window[e.name]=new Proxy(e,t)})}Jr();function Xr(){Element.prototype.toggleAttribute||(Element.prototype.toggleAttribute=function(t,e){return e!==void 0&&(e=!!e),this.hasAttribute(t)?e?!0:(this.removeAttribute(t),!1):e===!1?!1:(this.setAttribute(t,""),!0)})}const Gs=0,zo=1271266957,Ho=777,$o=2666e3,qo=777e3,Ko=2147483647,Jo="",Xo=20*1024*1024,Zr="",Zo=[7322096,16766590,13338331,9367192,16749490,16478047],Qo="default_static",Je=4294967296,ea=Je+1,Qr=new Set(["web","k","z","a"]),ta=2147483646,en=0,tn=1,sn=new Set([en,tn]);Math.max(...Array.from(sn))+1;const sa=!1;function rn(t,e){const s=t.findIndex(e);return s!==-1?t.splice(s,1)[0]:void 0}class ge{constructor(e){this._constructor(e)}_constructor(e){this.reuseResults=e,this.listeners={},this.listenerResults={}}addEventListener(e,s,r){var n;if(((n=this.listeners)[e]??(n[e]=[])).push({callback:s,options:r}),this.listenerResults.hasOwnProperty(e)&&(s(...this.listenerResults[e]),r?.once)){this.listeners[e].pop();return}}addMultipleEventsListeners(e){for(const s in e)this.addEventListener(s,e[s])}removeEventListener(e,s,r){this.listeners[e]&&rn(this.listeners[e],n=>n.callback===s)}invokeListenerCallback(e,s,...r){let n,i;try{n=s.callback(...r)}catch(o){i=o}if(s.options?.once&&this.removeEventListener(e,s.callback),i)throw i;return n}_dispatchEvent(e,s,...r){this.reuseResults&&(this.listenerResults[e]=r);const n=s&&[],i=this.listeners[e];return i&&i.slice().forEach(a=>{if(i.findIndex(l=>l.callback===a.callback)===-1)return;const u=this.invokeListenerCallback(e,a,...r);n&&n.push(u)}),n}dispatchResultableEvent(e,...s){return this._dispatchEvent(e,!0,...s)}dispatchEvent(e,...s){this._dispatchEvent(e,!1,...s)}cleanup(){this.listeners={},this.listenerResults={}}}const K={test:location.search.indexOf("test=1")>0,debug:location.search.indexOf("debug=1")>0,http:!1,ssl:!0,multipleConnections:!0,asServiceWorker:!1,transport:"websocket",noSharedWorker:location.search.indexOf("noSharedWorker=1")>0};K.http=location.search.indexOf("http=1")>0;K.http=!0;K.http&&(K.transport="https");const nn=!1,he=K.debug,on=typeof window<"u"?window:self,k=on,zs=Date.now()%Math.random()*1e8|0;function Ct(t,e){const s=t.indexOf(e);return(s===-1?void 0:t.splice(s,1))?.[0]}const xe=typeof ServiceWorkerGlobalScope<"u"&&self instanceof ServiceWorkerGlobalScope,lt=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&!xe,de=lt||xe,an=()=>self.clients.matchAll({includeUncontrolled:!1,type:"window"}),Hs=(t,...e)=>{try{t.postMessage(...e)}catch(s){console.error("[worker] postMessage error:",s,e)}},$s=(t,...e)=>{an().then(s=>{s.length&&s.slice(t?0:-1).forEach(r=>{Hs(r,...e)})})},qs=(...t)=>{Hs(self,...t)},Ks=()=>{};xe&&$s.bind(null,!1);xe&&$s.bind(null,!0);const St={};function Xe(t){return St[t]??(St[t]={type:t})}const cn=Date.now();function Ze(){return"["+((Date.now()-cn)/1e3).toFixed(3)+"]"}var es=(t=>(t[t.None=0]="None",t[t.Error=1]="Error",t[t.Warn=2]="Warn",t[t.Log=4]="Log",t[t.Debug=8]="Debug",t))(es||{});const un=[0,1,2,4,8],ln=q||le,hn=!ln,ps={reset:"\x1B[0m",bright:"\x1B[1m",dim:"\x1B[2m",underscore:"\x1B[4m",blink:"\x1B[5m",reverse:"\x1B[7m",hidden:"\x1B[8m",fg:{black:"\x1B[30m",red:"\x1B[31m",green:"\x1B[32m",yellow:"\x1B[33m",blue:"\x1B[34m",magenta:"\x1B[35m",cyan:"\x1B[36m",white:"\x1B[37m"},bg:{black:"\x1B[40m",red:"\x1B[41m",green:"\x1B[42m",yellow:"\x1B[43m",blue:"\x1B[44m",magenta:"\x1B[45m",cyan:"\x1B[46m",white:"\x1B[47m"}},dn=[["debug",8],["info",4],["warn",2],["error",1],["assert",1],["trace",4],["group",4],["groupCollapsed",4],["groupEnd",4]];function te(t,e=7,s=!1,r=""){let n;!he&&!s&&(e=1),hn?r||(xe?r=ps.fg.yellow:lt&&(r=ps.fg.cyan)):r="";const i=r;r?r=`%s ${r}%s`:r="%s";const o=function(...a){return e&4&&console.log(r,Ze(),t,...a)};return dn.forEach(([a,c])=>{o[a]=function(...u){return e&c&&console[a](r,Ze(),t,...u)}}),o.setPrefix=function(a){n=a,t="["+a+"]"},o.setPrefix(t),o.setLevel=function(a){e=un.slice(0,a+1).reduce((c,u)=>c|u,0)},o.bindPrefix=function(a,c=e){return te(`${n}] [${a}`,c,s,i)},o}const fn=!0;class ts extends ge{constructor(e){super(!1),this.logSuffix=e,this.onMessage=s=>{const r=s.data,n=s.source||s.currentTarget;this.processTaskMap[r.type](r,n,s)},this.processResultTask=s=>{const{taskId:r,result:n,error:i}=s.payload,o=this.awaiting[r];o&&(this.debug&&this.log.debug("done",o.taskType,n,i),"error"in s.payload?o.reject(i):o.resolve(n),delete this.awaiting[r])},this.processAckTask=s=>{const r=s.payload,n=this.awaiting[r.taskId];if(!n)return;const i=n.resolve,o={cached:r.cached,result:r.cached?"result"in r?Promise.resolve(r.result):Promise.reject(r.error):new Promise((a,c)=>{n.resolve=a,n.reject=c})};i(o),r.cached&&delete this.awaiting[r.taskId]},this.processPingTask=(s,r,n)=>{this.pushTask(this.createTask("pong",void 0),n.source)},this.processPongTask=(s,r,n)=>{const i=this.pingResolves.get(r);i&&(this.pingResolves.delete(r),i())},this.processCloseTask=(s,r,n)=>{this.detachPort(r)},this.processBatchTask=(s,r,n)=>{const i={data:n.data,source:n.source,currentTarget:n.currentTarget};s.payload.forEach(o=>{i.data=o,this.onMessage(i)})},this.processLockTask=(s,r,n)=>{const i=s.payload;this.requestedLocks.has(i)||(this.requestedLocks.set(i,r),navigator.locks.request(i,()=>{this.processCloseTask(void 0,r,void 0),this.requestedLocks.delete(i)}))},this.processInvokeTask=async(s,r,n)=>{const i=s.id,o=s.payload;let a,c,u;o.void||(a={taskId:i},c=this.createTask("result",a)),o.withAck&&(u=this.createTask("ack",{taskId:i,cached:!0}));let l;try{const d=this.listeners[o.type];if(!d?.length)throw new Error("no listener");const f=d[0];let m=this.invokeListenerCallback(o.type,f,o.payload,r,n);if(o.void)return;if(l=m instanceof Promise,u){const S=!l;if(u.payload.cached=S,S&&(u.payload.result=m),this.pushTask(u,r),S)return}l&&(m=await m),a.result=m}catch(d){if(this.log.error("worker task error:",d,s),o.void)return;if(u&&u.payload.cached){u.payload.error=d,this.pushTask(u,r);return}a.error=d}this.pushTask(c,r)},this.listenPorts=[],this.sendPorts=[],this.pingResolves=new Map,this.taskId=0,this.awaiting={},this.pending=new Map,this.log=te("MP"+(e?"-"+e:"")),this.debug=he,this.heldLocks=new Map,this.requestedLocks=new Map,this.processTaskMap={result:this.processResultTask,ack:this.processAckTask,invoke:this.processInvokeTask,ping:this.processPingTask,pong:this.processPongTask,close:this.processCloseTask,lock:this.processLockTask,batch:this.processBatchTask}}setOnPortDisconnect(e){this.onPortDisconnect=e}attachPort(e){this.attachListenPort(e),this.attachSendPort(e)}attachListenPort(e){this.listenPorts.push(e),e.addEventListener("message",this.onMessage)}attachSendPort(e){if(this.log.warn("attaching send port"),e.start?.(),this.sendPorts.push(e),typeof window<"u"&&fn)if("locks"in navigator){const s=["lock",zs,this.logSuffix||"",Math.random()*2147483647|0].join("-");this.log.warn("created lock",s);const r=new Promise(n=>this.heldLocks.set(e,{resolve:n,id:s})).then(()=>this.heldLocks.delete(e));navigator.locks.request(s,()=>(this.resendLockTask(e),r))}else window.addEventListener("beforeunload",()=>{const s=this.createTask("close",void 0);this.postMessage(void 0,s)});this.releasePending()}resendLockTask(e){const s=this.heldLocks.get(e);s&&this.pushTask(this.createTask("lock",s.id),e)}detachPort(e){this.log.warn("disconnecting port"),Ct(this.listenPorts,e),Ct(this.sendPorts,e),e.removeEventListener?.("message",this.onMessage),e.close?.(),this.onPortDisconnect?.(e),this.heldLocks.get(e)?.resolve();const r=Xe("PORT_DISCONNECTED");for(const n in this.awaiting){const i=this.awaiting[n];i.port===e&&(i.reject(r),delete this.awaiting[n])}}postMessage(e,s){(Array.isArray(e)?e:e?[e]:this.sendPorts).forEach(n=>{n.postMessage(s,s.transfer)})}async releasePending(){this.releasingPending||(this.releasingPending=!0,await Promise.resolve(),this.debug&&this.log.debug("releasing tasks, length:",this.pending.size),this.pending.forEach((e,s)=>{let r=e;{let i;r=[],e.forEach(o=>{o.transfer?(i=void 0,r.push(o)):(i||(i=this.createTask("batch",[]),r.push(i)),i.payload.push(o))})}const n=s?[s]:this.sendPorts;n.length&&(r.forEach(i=>{try{this.postMessage(n,i)}catch(o){this.log.error("postMessage error:",o,i,n)}}),this.pending.delete(s))}),this.debug&&this.log.debug("released tasks"),this.releasingPending=!1)}createTask(e,s,r){return{type:e,payload:s,id:this.taskId++,transfer:r}}createInvokeTask(e,s,r,n,i){return this.createTask("invoke",{type:e,payload:s,withAck:r,void:n},i)}pushTask(e,s){let r=this.pending.get(s);r||this.pending.set(s,r=[]),r.push(e),this.releasePending()}invokeVoid(e,s,r,n){const i=this.createInvokeTask(e,s,void 0,!0,n);this.pushTask(i,r)}invoke(e,s,r,n,i){this.debug&&this.log.debug("start",e,s);let o;const a=new Promise((c,u)=>{o=this.createInvokeTask(e,s,r,void 0,i),this.awaiting[o.id]={resolve:c,reject:u,taskType:e,port:n},this.pushTask(o,n)});if(de){a.finally(()=>{clearInterval(c)});const c=Xt.setInterval(()=>{this.log.error("task still has no result",o,n)},6e4)}return a}invokeExceptSource(e,s,r){const n=this.sendPorts.slice();Ct(n,r),n.forEach(i=>{this.invokeVoid(e,s,i)})}}class Be extends ts{constructor(){super("MTPROTO"),Be.INSTANCE=this,k&&(k.mtprotoMessagePort=this)}static getInstance(){return this.INSTANCE}}class gn extends ge{constructor(){super(),this.myId=Gs,this.connectionStatus={},this.premium=!1,this.addEventListener("user_auth",({id:e})=>{this.myId=e.toPeerId()}),this.addEventListener("premium_toggle_private",({isNew:e,isPremium:s})=>{this.premium=s,this.dispatchEventSingle("premium_toggle",s)}),this.addEventListener("connection_status_change",e=>{this.connectionStatus[e.name]=e}),this.dispatchEvent=(e,...s)=>{super.dispatchEvent(e,...s),Be.getInstance().invokeVoid("event",{name:e,args:s})},de||this.addEventListener("settings_updated",({settings:e})=>{this.settings=e})}getConnectionStatus(){return this.connectionStatus}getPremium(){return this.premium}dispatchEventSingle(...e){super.dispatchEvent(...e)}}const C=new gn;k.rootScope=C;const mn={isFulfilled:!1,isRejected:!1,notify:()=>{},notifyAll:function(...t){this.lastNotify=t,this.listeners?.forEach(e=>e(...t))},addNotifyListener:function(t){this.lastNotify&&t(...this.lastNotify),(this.listeners??(this.listeners=[])).push(t)},resolve:function(t){this.isFulfilled||this.isRejected||(this.isFulfilled=!0,this._resolve(t),this.onFinish())},reject:function(...t){this.isRejected||this.isFulfilled||(this.isRejected=!0,this._reject(...t),this.onFinish())},onFinish:function(){this.notify=this.notifyAll=this.lastNotify=null,this.listeners&&(this.listeners.length=0),this.cancel&&(this.cancel=Ke)}};function Z(){let t,e;const s=new Promise((r,n)=>{t=r,e=n});return Object.assign(s,mn),s._resolve=t,s._reject=e,s}self.deferredPromise=Z;function bt(t,e,s=!0){let r=null,n,i;const o=()=>{clearInterval(r),r=null},a=(...c)=>{n=!0,i=c,r||(s&&(n=!1,t(...i)),r=setInterval(()=>{if(!n){o();return}n=!1,t(...i)},e))};return a.clear=o,a}function Nt(t,e){if(e)for(const s in e)e[s]!==void 0&&(t[s]=e[s]);return t}const Le=class Le{constructor(e){Nt(this,e),K.test&&(this.name+="_test"),this.storageIsAvailable=!0,this.log=te(["IDB",e.name].join("-")),this.log("constructor"),this.openDatabase(!0),Le.INSTANCES.push(this)}isAvailable(){return this.storageIsAvailable}openDatabase(e=!1){if(this.openDbPromise&&!e)return this.openDbPromise;const s=(o,a)=>{const c=Array.from(o.indexNames);for(const u of c)o.deleteIndex(u);if(a.indexes?.length)for(const u of a.indexes)o.indexNames.contains(u.indexName)||o.createIndex(u.indexName,u.keyPath,u.objectParameters)},r=(o,a)=>{const c=o.createObjectStore(a.name);s(c,a)};try{var n=indexedDB.open(this.name,this.version);if(!n)return Promise.reject()}catch(o){return this.log.error("error opening db",o.message),this.storageIsAvailable=!1,Promise.reject(o)}let i=!1;return setTimeout(()=>{i||n.onerror(Xe("IDB_CREATE_TIMEOUT"))},3e3),this.openDbPromise=new Promise((o,a)=>{n.onsuccess=c=>{i=!0;const u=n.result;let l=!1;this.log("Opened"),u.onerror=d=>{this.storageIsAvailable=!1,this.log.error("Error creating/accessing IndexedDB database",d),a(d)},u.onclose=d=>{this.log.error("closed:",d),!l&&this.openDatabase()},u.onabort=d=>{this.log.error("abort:",d);const f=d.target;this.openDatabase(l=!0),f.onerror&&f.onerror(d),u.close()},u.onversionchange=d=>{this.log.error("onversionchange, lol?")},o(this.db=u)},n.onerror=c=>{i=!0,this.storageIsAvailable=!1,this.log.error("Error creating/accessing IndexedDB database",c),a(c)},n.onupgradeneeded=c=>{i=!0,this.log.warn("performing idb upgrade from",c.oldVersion,"to",c.newVersion);const u=c.target,l=u.result;this.stores.forEach(d=>{if(!l.objectStoreNames.contains(d.name))r(l,d);else{const m=u.transaction.objectStore(d.name);s(m,d)}})}})}static create(e){return this.INSTANCES.find(s=>s.name===e.name)??new Le(e)}static closeDatabases(e){this.INSTANCES.forEach(s=>{if(e&&e===s)return;const r=s.db;r&&(r.onclose=()=>{},r.close())})}};Le.INSTANCES=[];let Ut=Le;class Dn{constructor(e,s){this.storeName=s,this.log=te(["IDB",e.name,s].join("-")),this.idb=Ut.create(e)}delete(e,s){const r=Array.isArray(e);return r||(e=[].concat(e)),this.getObjectStore("readwrite",n=>{const i=e.map(o=>n.delete(o));return r?i:i[0]},"",s)}clear(e){return this.getObjectStore("readwrite",s=>s.clear(),"",e)}save(e,s,r){const n=Array.isArray(e);return n||(e=[].concat(e),s=[].concat(s)),this.getObjectStore("readwrite",i=>{const o=e.map((a,c)=>i.put(s[c],a));return n?o:o[0]},"",r)}get(e,s){const r=Array.isArray(e);if(r){if(!e.length)return Promise.resolve([])}else{if(!e)return;e=[].concat(e)}return this.getObjectStore("readonly",n=>{const i=e.map(o=>n.get(o));return r?i:i[0]},"",s)}getObjectStore(e,s,r,n=this.storeName){let i;return r&&(i=performance.now(),this.log(r+": start")),this.idb.openDatabase().then(o=>new Promise((a,c)=>{const u=o.transaction([n],e),l=()=>{clearTimeout(m),c(u.error)},d=()=>{clearTimeout(m),r&&this.log(r+": end",performance.now()-i);const P=p.map(T=>T.result);a(A?P:P[0])};u.onerror=l;const f=e==="readwrite";f&&(u.oncomplete=()=>d());const m=setTimeout(()=>{this.log.error("transaction not finished",u,r)},1e4),S=s(u.objectStore(n)),A=Array.isArray(S),p=A?S:[].concat(S);if(f)return;const y=p.length;let w=y;const _=()=>{u.error||--w||d()};for(let P=0;P<y;++P){const T=p[P];T.onerror=l,T.onsuccess=_}}))}getAll(e){return this.getObjectStore("readonly",s=>s.getAll(),"",e)}}function Fs(){}const wt=16,Ee=class Ee{constructor(e,s){this.db=e,this.storeName=s,this.cache={},this.getPromises=new Map,this.keysToSet=new Set,this.saveDeferred=Z(),this.keysToDelete=new Set,this.deleteDeferred=Z(),this.storage=new Dn(e,s),Ee.STORAGES.length?this.useStorage=Ee.STORAGES[0].useStorage:this.useStorage=!0,this.savingFreezed=!1,Ee.STORAGES.push(this),this.saveThrottled=bt(async()=>{const r=this.saveDeferred;this.saveDeferred=Z();const n=this.keysToSet;if(n.size){const i=Array.from(n.values());n.clear();const o=i.map(a=>this.cache[a]);try{await this.storage.save(i,o)}catch(a){console.error("[AS]: set error:",a,i,o)}}r.resolve(),n.size&&this.saveThrottled()},wt,!1),this.deleteThrottled=bt(async()=>{const r=this.deleteDeferred;this.deleteDeferred=Z();const n=this.keysToDelete;if(n.size){const i=Array.from(n.values());n.clear();try{await this.storage.delete(i)}catch(o){console.error("[AS]: delete error:",o,i)}}r.resolve(),n.size&&this.deleteThrottled()},wt,!1),this.getThrottled=bt(async()=>{const r=Array.from(this.getPromises.keys());this.storage.get(r).then(n=>{for(let i=0,o=r.length;i<o;++i){const a=r[i],c=this.getPromises.get(a);c&&(c.resolve(this.cache[a]=n[i]),this.getPromises.delete(a))}},n=>{new Set(["NO_ENTRY_FOUND","STORAGE_OFFLINE"]).has(n.type)||(this.useStorage=!1,console.error("[AS]: get error:",n,r,s));for(let o=0,a=r.length;o<a;++o){const c=r[o],u=this.getPromises.get(c);u&&(u.resolve(void 0),this.getPromises.delete(c))}}).finally(()=>{this.getPromises.size&&this.getThrottled()})},wt,!1)}isAvailable(){return this.useStorage}getCache(){return this.cache}getFromCache(e){return this.cache[e]}setToCache(e,s){return this.cache[e]=s}async get(e,s=!0){if(this.cache.hasOwnProperty(e)&&s)return this.getFromCache(e);if(this.useStorage){const r=this.getPromises.get(e);if(r)return r;const n=Z();return this.getPromises.set(e,n),this.getThrottled(),n}}getAll(){return this.storage.getAll().catch(()=>[])}set(e,s=!1){const r=this.useStorage&&!s&&!this.savingFreezed;for(const n in e)if(e.hasOwnProperty(n)){const i=e[n];this.setToCache(n,i),r&&(this.keysToSet.add(n),this.keysToDelete.delete(n),this.saveThrottled())}return r?this.saveDeferred:Promise.resolve()}delete(e,s=!1){return e=""+e,s||delete this.cache[e],this.useStorage&&(this.keysToSet.delete(e),this.keysToDelete.add(e),this.deleteThrottled()),this.useStorage?this.deleteDeferred:Promise.resolve()}clear(e=!1){if(!e)for(const s in this.cache)delete this.cache[s];return this.storage.clear().catch(Fs)}static toggleStorage(e,s){return Promise.all(this.STORAGES.map(r=>{if(r.useStorage=e,!(!de||!s))return e?r.set(r.cache):(r.keysToSet.clear(),r.keysToDelete.clear(),r.getPromises.forEach(n=>n.resolve(void 0)),r.getPromises.clear(),r.clear(!0))})).catch(Fs)}static freezeSaving(e,s){this.STORAGES.forEach(r=>r.savingFreezed=!0);try{e()}catch(r){console.error("freezeSaving callback error:",r)}this.STORAGES.forEach(r=>r.savingFreezed=!1)}};Ee.STORAGES=[];let Me=Ee;k&&(k.AppStorage=Me);const pn={name:"tweb",version:7,stores:[{name:"session"},{name:"stickerSets"},{name:"users"},{name:"chats"},{name:"dialogs"},{name:"messages"}]};class Fn extends Me{constructor(){super(pn,"session")}}const ye=new Fn;k.stateStorage=ye;function Js(t,e,s){const r=s&&new Set(s),n=c=>Object.keys(c).filter(u=>c[u]!==void 0),i=s?c=>n(c).filter(u=>!r.has(u)):n,o=typeof t;return t&&e&&o==="object"&&o===typeof e?i(t).length===i(e).length&&i(t).every(c=>Js(t[c],e[c],s)):t===e}function ht(t){return t.charAt(0).toUpperCase()+t.slice(1)}const En=new Set(["javascript:"]);function Xs(t){if(!t)return null;try{const e=new URL(t).protocol;return En.has(e)?null:e}catch{return null}}const vn="((?:ð¨ð»ââ¤ï¸?âðâð¨\uD83C[\uDFFB-\uDFFF]|ð¨ð¼ââ¤ï¸?âðâð¨\uD83C[\uDFFB-\uDFFF]|ð¨ð½ââ¤ï¸?âðâð¨\uD83C[\uDFFB-\uDFFF]|ð¨ð¾ââ¤ï¸?âðâð¨\uD83C[\uDFFB-\uDFFF]|ð¨ð¿ââ¤ï¸?âðâð¨\uD83C[\uDFFB-\uDFFF]|ð©ð»ââ¤ï¸?âðâð¨\uD83C[\uDFFB-\uDFFF]|ð©ð»ââ¤ï¸?âðâð©\uD83C[\uDFFB-\uDFFF]|ð©ð¼ââ¤ï¸?âðâð¨\uD83C[\uDFFB-\uDFFF]|ð©ð¼ââ¤ï¸?âðâð©\uD83C[\uDFFB-\uDFFF]|ð©ð½ââ¤ï¸?âðâð¨\uD83C[\uDFFB-\uDFFF]|ð©ð½ââ¤ï¸?âðâð©\uD83C[\uDFFB-\uDFFF]|ð©ð¾ââ¤ï¸?âðâð¨\uD83C[\uDFFB-\uDFFF]|ð©ð¾ââ¤ï¸?âðâð©\uD83C[\uDFFB-\uDFFF]|ð©ð¿ââ¤ï¸?âðâð¨\uD83C[\uDFFB-\uDFFF]|ð©ð¿ââ¤ï¸?âðâð©\uD83C[\uDFFB-\uDFFF]|ð§ð»ââ¤ï¸?âðâð§\uD83C[\uDFFC-\uDFFF]|ð§ð¼ââ¤ï¸?âðâð§\uD83C[\uDFFB\uDFFD-\uDFFF]|ð§ð½ââ¤ï¸?âðâð§\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF]|ð§ð¾ââ¤ï¸?âðâð§\uD83C[\uDFFB-\uDFFD\uDFFF]|ð§ð¿ââ¤ï¸?âðâð§\uD83C[\uDFFB-\uDFFE]|ð¨ð»ââ¤ï¸?âð¨\uD83C[\uDFFB-\uDFFF]|ð¨ð»âð¤âð¨\uD83C[\uDFFC-\uDFFF]|ð¨ð¼ââ¤ï¸?âð¨\uD83C[\uDFFB-\uDFFF]|ð¨ð¼âð¤âð¨\uD83C[\uDFFB\uDFFD-\uDFFF]|ð¨ð½ââ¤ï¸?âð¨\uD83C[\uDFFB-\uDFFF]|ð¨ð½âð¤âð¨\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF]|ð¨ð¾ââ¤ï¸?âð¨\uD83C[\uDFFB-\uDFFF]|ð¨ð¾âð¤âð¨\uD83C[\uDFFB-\uDFFD\uDFFF]|ð¨ð¿ââ¤ï¸?âð¨\uD83C[\uDFFB-\uDFFF]|ð¨ð¿âð¤âð¨\uD83C[\uDFFB-\uDFFE]|ð©ð»ââ¤ï¸?âð¨\uD83C[\uDFFB-\uDFFF]|ð©ð»ââ¤ï¸?âð©\uD83C[\uDFFB-\uDFFF]|ð©ð»âð¤âð¨\uD83C[\uDFFC-\uDFFF]|ð©ð»âð¤âð©\uD83C[\uDFFC-\uDFFF]|ð©ð¼ââ¤ï¸?âð¨\uD83C[\uDFFB-\uDFFF]|ð©ð¼ââ¤ï¸?âð©\uD83C[\uDFFB-\uDFFF]|ð©ð¼âð¤âð¨\uD83C[\uDFFB\uDFFD-\uDFFF]|ð©ð¼âð¤âð©\uD83C[\uDFFB\uDFFD-\uDFFF]|ð©ð½ââ¤ï¸?âð¨\uD83C[\uDFFB-\uDFFF]|ð©ð½ââ¤ï¸?âð©\uD83C[\uDFFB-\uDFFF]|ð©ð½âð¤âð¨\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF]|ð©ð½âð¤âð©\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF]|ð©ð¾ââ¤ï¸?âð¨\uD83C[\uDFFB-\uDFFF]|ð©ð¾ââ¤ï¸?âð©\uD83C[\uDFFB-\uDFFF]|ð©ð¾âð¤âð¨\uD83C[\uDFFB-\uDFFD\uDFFF]|ð©ð¾âð¤âð©\uD83C[\uDFFB-\uDFFD\uDFFF]|ð©ð¿ââ¤ï¸?âð¨\uD83C[\uDFFB-\uDFFF]|ð©ð¿ââ¤ï¸?âð©\uD83C[\uDFFB-\uDFFF]|ð©ð¿âð¤âð¨\uD83C[\uDFFB-\uDFFE]|ð©ð¿âð¤âð©\uD83C[\uDFFB-\uDFFE]|ð§ð»ââ¤ï¸?âð§\uD83C[\uDFFC-\uDFFF]|ð§ð»âð¤âð§\uD83C[\uDFFB-\uDFFF]|ð§ð¼ââ¤ï¸?âð§\uD83C[\uDFFB\uDFFD-\uDFFF]|ð§ð¼âð¤âð§\uD83C[\uDFFB-\uDFFF]|ð§ð½ââ¤ï¸?âð§\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF]|ð§ð½âð¤âð§\uD83C[\uDFFB-\uDFFF]|ð§ð¾ââ¤ï¸?âð§\uD83C[\uDFFB-\uDFFD\uDFFF]|ð§ð¾âð¤âð§\uD83C[\uDFFB-\uDFFF]|ð§ð¿ââ¤ï¸?âð§\uD83C[\uDFFB-\uDFFE]|ð§ð¿âð¤âð§\uD83C[\uDFFB-\uDFFF]|ð¨ââ¤ï¸?âðâð¨|ð©ââ¤ï¸?âðâ\uD83D[\uDC68\uDC69]|ð«±ð»âð«²\uD83C[\uDFFC-\uDFFF]|ð«±ð¼âð«²\uD83C[\uDFFB\uDFFD-\uDFFF]|ð«±ð½âð«²\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF]|ð«±ð¾âð«²\uD83C[\uDFFB-\uDFFD\uDFFF]|ð«±ð¿âð«²\uD83C[\uDFFB-\uDFFE]|ð¨ââ¤ï¸?âð¨|ð©ââ¤ï¸?â\uD83D[\uDC68\uDC69]|ð§âð¤âð§|ð«\uD83C[\uDFFB-\uDFFF]|ð¬\uD83C[\uDFFB-\uDFFF]|ð­\uD83C[\uDFFB-\uDFFF]|ð\uD83C[\uDFFB-\uDFFF]|ð\uD83C[\uDFFB-\uDFFF]|ð¤\uD83C[\uDFFB-\uDFFF]|\uD83D[\uDC6B-\uDC6D\uDC8F\uDC91]|ð¤)|(?:\uD83D[\uDC68\uDC69]|ð§)(?:\uD83C[\uDFFB-\uDFFF])?â(?:âï¸?|âï¸?|âï¸?|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|(?:\uD83C[\uDFCB\uDFCC]|\uD83D[\uDD74\uDD75]|â¹)(?:(?:\uD83C[\uDFFB-\uDFFF]|ï¸?)â[ââ]ï¸?)|(?:\uD83C[\uDFC3\uDFC4\uDFCA]|\uD83D[\uDC6E\uDC70\uDC71\uDC73\uDC77\uDC81\uDC82\uDC86\uDC87\uDE45-\uDE47\uDE4B\uDE4D\uDE4E\uDEA3\uDEB4-\uDEB6]|\uD83E[\uDD26\uDD35\uDD37-\uDD39\uDD3D\uDD3E\uDDB8\uDDB9\uDDCD-\uDDCF\uDDD4\uDDD6-\uDDDD])(?:\uD83C[\uDFFB-\uDFFF])?â[ââ]ï¸?|(?:ð¨âð¨âð¦âð¦|ð¨âð¨âð§â\uD83D[\uDC66\uDC67]|ð¨âð©âð¦âð¦|ð¨âð©âð§â\uD83D[\uDC66\uDC67]|ð©âð©âð¦âð¦|ð©âð©âð§â\uD83D[\uDC66\uDC67]|ð¨âð¦âð¦|ð¨âð§â\uD83D[\uDC66\uDC67]|ð¨âð¨â\uD83D[\uDC66\uDC67]|ð¨âð©â\uD83D[\uDC66\uDC67]|ð©âð¦âð¦|ð©âð§â\uD83D[\uDC66\uDC67]|ð©âð©â\uD83D[\uDC66\uDC67]|ð³ï¸?ââ§ï¸?|ð³ï¸?âð|ð¶âð«ï¸?|â¤ï¸?âð¥|â¤ï¸?âð©¹|ð´ââ ï¸?|ðâð¦º|ð»ââï¸?|ðâð¨|ð¨â\uD83D[\uDC66\uDC67]|ð©â\uD83D[\uDC66\uDC67]|ð¯ââï¸?|ð¯ââï¸?|ð®âð¨|ðµâð«|ð¤¼ââï¸?|ð¤¼ââï¸?|ð§ââï¸?|ð§ââï¸?|ð§ââï¸?|ð§ââï¸?|ðââ¬)|[#*0-9]ï¸??â£|(?:[Â©Â®â¢â]ï¸?)|(?:\uD83C[\uDC04\uDD70\uDD71\uDD7E\uDD7F\uDE02\uDE1A\uDE2F\uDE37\uDF21\uDF24-\uDF2C\uDF36\uDF7D\uDF96\uDF97\uDF99-\uDF9B\uDF9E\uDF9F\uDFCD\uDFCE\uDFD4-\uDFDF\uDFF3\uDFF5\uDFF7]|\uD83D[\uDC3F\uDC41\uDCFD\uDD49\uDD4A\uDD6F\uDD70\uDD73\uDD76-\uDD79\uDD87\uDD8A-\uDD8D\uDDA5\uDDA8\uDDB1\uDDB2\uDDBC\uDDC2-\uDDC4\uDDD1-\uDDD3\uDDDC-\uDDDE\uDDE1\uDDE3\uDDE8\uDDEF\uDDF3\uDDFA\uDECB\uDECD-\uDECF\uDEE0-\uDEE5\uDEE9\uDEF0\uDEF3]|[â¼ââ¹â-ââ©âªâââ¨ââ­-â¯â±â²â¸-âºââªâ«â¶ââ»-â¾â-âââââââ â¢â£â¦âªâ®â¯â¸-âºâââ-ââ â£â¥â¦â¨â»â¿â-âââââ â¡â§âªâ«â°â±â½â¾ââââââââ©âªâ°-âµâ¸âºâ½âââââââââ¡â³â´ââââ£â¤â¡â¤´â¤µâ¬-â¬â¬â¬â­â­ã°ã½ãã])(?:ï¸?|(?!ï¸))|(?:(?:\uD83C[\uDFCB\uDFCC]|\uD83D[\uDD74\uDD75\uDD90]|[ââ·â¹ââ])(?:ï¸?|(?!ï¸))|(?:\uD83C[\uDF85\uDFC2-\uDFC4\uDFC7\uDFCA]|\uD83D[\uDC42\uDC43\uDC46-\uDC50\uDC66-\uDC69\uDC6E\uDC70-\uDC78\uDC7C\uDC81-\uDC83\uDC85-\uDC87\uDCAA\uDD7A\uDD95\uDD96\uDE45-\uDE47\uDE4B-\uDE4F\uDEA3\uDEB4-\uDEB6\uDEC0\uDECC]|\uD83E[\uDD0C\uDD0F\uDD18-\uDD1C\uDD1E\uDD1F\uDD26\uDD30-\uDD39\uDD3D\uDD3E\uDD77\uDDB5\uDDB6\uDDB8\uDDB9\uDDBB\uDDCD-\uDDCF\uDDD1-\uDDDD\uDEC3-\uDEC5\uDEF0-\uDEF6]|[ââ]))(?:\uD83C[\uDFFB-\uDFFF])?|(?:ð´ó §ó ¢ó ¥ó ®ó §ó ¿|ð´ó §ó ¢ó ³ó £ó ´ó ¿|ð´ó §ó ¢ó ·ó ¬ó ³ó ¿|ð¦\uD83C[\uDDE8-\uDDEC\uDDEE\uDDF1\uDDF2\uDDF4\uDDF6-\uDDFA\uDDFC\uDDFD\uDDFF]|ð§\uD83C[\uDDE6\uDDE7\uDDE9-\uDDEF\uDDF1-\uDDF4\uDDF6-\uDDF9\uDDFB\uDDFC\uDDFE\uDDFF]|ð¨\uD83C[\uDDE6\uDDE8\uDDE9\uDDEB-\uDDEE\uDDF0-\uDDF5\uDDF7\uDDFA-\uDDFF]|ð©\uD83C[\uDDEA\uDDEC\uDDEF\uDDF0\uDDF2\uDDF4\uDDFF]|ðª\uD83C[\uDDE6\uDDE8\uDDEA\uDDEC\uDDED\uDDF7-\uDDFA]|ð«\uD83C[\uDDEE-\uDDF0\uDDF2\uDDF4\uDDF7]|ð¬\uD83C[\uDDE6\uDDE7\uDDE9-\uDDEE\uDDF1-\uDDF3\uDDF5-\uDDFA\uDDFC\uDDFE]|ð­\uD83C[\uDDF0\uDDF2\uDDF3\uDDF7\uDDF9\uDDFA]|ð®\uD83C[\uDDE8-\uDDEA\uDDF1-\uDDF4\uDDF6-\uDDF9]|ð¯\uD83C[\uDDEA\uDDF2\uDDF4\uDDF5]|ð°\uD83C[\uDDEA\uDDEC-\uDDEE\uDDF2\uDDF3\uDDF5\uDDF7\uDDFC\uDDFE\uDDFF]|ð±\uD83C[\uDDE6-\uDDE8\uDDEE\uDDF0\uDDF7-\uDDFB\uDDFE]|ð²\uD83C[\uDDE6\uDDE8-\uDDED\uDDF0-\uDDFF]|ð³\uD83C[\uDDE6\uDDE8\uDDEA-\uDDEC\uDDEE\uDDF1\uDDF4\uDDF5\uDDF7\uDDFA\uDDFF]|ð´ð²|ðµ\uD83C[\uDDE6\uDDEA-\uDDED\uDDF0-\uDDF3\uDDF7-\uDDF9\uDDFC\uDDFE]|ð¶ð¦|ð·\uD83C[\uDDEA\uDDF4\uDDF8\uDDFA\uDDFC]|ð¸\uD83C[\uDDE6-\uDDEA\uDDEC-\uDDF4\uDDF7-\uDDF9\uDDFB\uDDFD-\uDDFF]|ð¹\uD83C[\uDDE6\uDDE8\uDDE9\uDDEB-\uDDED\uDDEF-\uDDF4\uDDF7\uDDF9\uDDFB\uDDFC\uDDFF]|ðº\uD83C[\uDDE6\uDDEC\uDDF2\uDDF3\uDDF8\uDDFE\uDDFF]|ð»\uD83C[\uDDE6\uDDE8\uDDEA\uDDEC\uDDEE\uDDF3\uDDFA]|ð¼\uD83C[\uDDEB\uDDF8]|ð½ð°|ð¾\uD83C[\uDDEA\uDDF9]|ð¿\uD83C[\uDDE6\uDDF2\uDDFC]|\uD83C[\uDCCF\uDD8E\uDD91-\uDD9A\uDDE6-\uDDFF\uDE01\uDE32-\uDE36\uDE38-\uDE3A\uDE50\uDE51\uDF00-\uDF20\uDF2D-\uDF35\uDF37-\uDF7C\uDF7E-\uDF84\uDF86-\uDF93\uDFA0-\uDFC1\uDFC5\uDFC6\uDFC8\uDFC9\uDFCF-\uDFD3\uDFE0-\uDFF0\uDFF4\uDFF8-\uDFFF]|\uD83D[\uDC00-\uDC3E\uDC40\uDC44\uDC45\uDC51-\uDC65\uDC6A\uDC6F\uDC79-\uDC7B\uDC7D-\uDC80\uDC84\uDC88-\uDC8E\uDC90\uDC92-\uDCA9\uDCAB-\uDCFC\uDCFF-\uDD3D\uDD4B-\uDD4E\uDD50-\uDD67\uDDA4\uDDFB-\uDE44\uDE48-\uDE4A\uDE80-\uDEA2\uDEA4-\uDEB3\uDEB7-\uDEBF\uDEC1-\uDEC5\uDED0-\uDED2\uDED5-\uDED7\uDEDD-\uDEDF\uDEEB\uDEEC\uDEF4-\uDEFC\uDFE0-\uDFEB\uDFF0]|\uD83E[\uDD0D\uDD0E\uDD10-\uDD17\uDD20-\uDD25\uDD27-\uDD2F\uDD3A\uDD3C\uDD3F-\uDD45\uDD47-\uDD76\uDD78-\uDDB4\uDDB7\uDDBA\uDDBC-\uDDCC\uDDD0\uDDDE-\uDDFF\uDE70-\uDE74\uDE78-\uDE7C\uDE80-\uDE86\uDE90-\uDEAC\uDEB0-\uDEBA\uDEC0-\uDEC2\uDED0-\uDED9\uDEE0-\uDEE7]|[â©-â¬â°â³â¾âââ¨âââ-ââ-ââ°â¿î])|ï¸)",Te="a-z\\u00c0-\\u00d6\\u00d8-\\u00f6\\u00f8-\\u00ff\\u0100-\\u024f\\u0253\\u0254\\u0256\\u0257\\u0259\\u025b\\u0263\\u0268\\u026f\\u0272\\u0289\\u028b\\u02bb\\u0300-\\u036f\\u1e00-\\u1eff\\u0400-\\u04ff\\u0500-\\u0527\\u2de0-\\u2dff\\ua640-\\ua69f\\u0591-\\u05bf\\u05c1-\\u05c2\\u05c4-\\u05c5\\u05c7\\u05d0-\\u05ea\\u05f0-\\u05f4\\ufb1d-\\ufb28\\ufb2a-\\ufb36\\ufb38-\\ufb3c\\ufb3e\\ufb40-\\ufb41\\ufb43-\\ufb44\\ufb46-\\ufb4f\\u0610-\\u061a\\u0620-\\u065f\\u066e-\\u06d3\\u06d5-\\u06dc\\u06de-\\u06e8\\u06ea-\\u06ef\\u06fa-\\u06fc\\u06ff\\u0750-\\u077f\\u08a0\\u08a2-\\u08ac\\u08e4-\\u08fe\\ufb50-\\ufbb1\\ufbd3-\\ufd3d\\ufd50-\\ufd8f\\ufd92-\\ufdc7\\ufdf0-\\ufdfb\\ufe70-\\ufe74\\ufe76-\\ufefc\\u200c\\u0e01-\\u0e3a\\u0e40-\\u0e4e\\u1100-\\u11ff\\u3130-\\u3185\\uA960-\\uA97F\\uAC00-\\uD7AF\\uD7B0-\\uD7FF\\u3003\\u3005\\u303b\\uff21-\\uff3a\\uff41-\\uff5a\\uff66-\\uff9f\\uffa1-\\uffdc",yn="0-9_"+Te,Es="Â·",Ue="["+Te+"0-9]",Cn="((?:https?|ftp)://|mailto:)?",Sn=Cn+"(?:"+Ue+"{1,64}(?::"+Ue+"{0,64})?@)?(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])(?:\\.(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])){3}|"+Ue+"["+Te+Es+"0-9-]{0,64}(?:\\."+Ue+"["+Te+Es+"0-9-]{0,64}){0,10}(?:\\.(xn--[0-9a-z]{2,16}|["+Te+`]{2,24})))(?::\\d{2,5})?(?:/(?:\\S{0,255}[^\\s.;,(\\[\\]{}<>"'])?)?`,Zs="[a-zA-Z\\d_]{5,32}",bn="(?:\\s|^)((?:\\d{1,2}:)?(?:[0-5]?[0-9]):(?:[0-5][0-9]))(?:\\s|$)",wn="\\/([a-zA-Z\\d_]{1,32})(?:@("+Zs+"))?(\\b|$)",ra=new RegExp("(^| )(@)("+Zs+")|("+Sn+")|(\\n)|("+vn+")|(^|[\\s\\(\\]])(#["+yn+"]{2,64})|(^|\\s)"+wn+"|"+bn,"i"),na=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,ia=/(^|\s|\n)(````?)([\s\S]+?)(````?)([\s\n\.,:?!;]|$)|(^|\s|\x01)(`|~~|\*\*|__|_-_|\|\|)([^\n]+?)\7([\x01\s\.,:?!;]|$)|@(\d+)\s*\((.+?)\)|(\[(.+?)\]\((.+?)\))/m,oa={Telegram:"tg://search_hashtag?hashtag={1}",Twitter:"https://twitter.com/hashtag/{1}",Instagram:"https://instagram.com/explore/tags/{1}/","Google Plus":"https://plus.google.com/explore/{1}"},Wt={"`":"messageEntityCode","``":"messageEntityPre","**":"messageEntityBold",__:"messageEntityItalic","~~":"messageEntityStrike","_-_":"messageEntityUnderline","||":"messageEntitySpoiler"};new Set(Object.values(Wt));const Qs=new Set(["messageEntityEmoji","messageEntityLinebreak","messageEntityCaret"]),aa=new Set(Qs);for(const t in Wt)Qs.add(Wt[t]);const _n=/^\+\d+$/;function er(t,e){Xs(t)||(t="https://"+t);const s={url:t};let r,n,i;if(r=t.match(/^(?:https?:\/\/)?(?:(.+?)\.)?(?:(?:web|k|z|a)\.)?t(?:elegram)?\.me(?:\/(.+))?/)){const o=new URL(t);let a=r[1];a&&Qr.has(r[1])&&(a=void 0),a&&(o.pathname=a+(o.pathname==="/"?"":o.pathname));const c=o.pathname.slice(1),u=c.split("/");if(u[0]&&u[0][0]==="$"&&u[0].length>1)i="invoice";else if(/^\+/.test(c)&&!_n.test(c))i="joinchat";else if(u[0])switch(u[0]){case"addlist":case"joinchat":case"addstickers":case"addemoji":case"voicechat":case"invoice":case"boost":case"giftcode":if(u.length!==1&&!a){i=u[0];break}default:if(u.length<=2||u[1]?.match(/^\d+(?:\?(?:comment|thread)=\d+)?$/)||u[1]==="s"){i="im";break}break}}else t.match(/^(?:https?:\/\/)?telesco\.pe\/([^/?]+)\/(\d+)/)?i="im":(n=t.match(/tg:(?:\/\/)?(.+?)(?:\?|$)/))&&(i="tg_"+n[1]);return window[i]||(i=void 0),s.onclick=i,s}k&&(k.wrapUrl=er);function ca(t,e){tr(t),e===void 0?t.replaceChildren():typeof e=="string"?e?t.textContent=e:t.replaceChildren():t.replaceChildren(e)}function tr(t){t.setAttribute("dir","auto")}const ua={messageActionChatCreate:"ActionCreateGroup",messageActionChatCreateYou:"ActionYouCreateGroup",messageActionChatEditTitle:"ActionChangedTitle",messageActionChatEditPhoto:"ActionChangedPhoto",messageActionChatEditVideo:"ActionChangedVideo",messageActionChatDeletePhoto:"ActionRemovedPhoto",messageActionChatReturn:"ActionAddUserSelf",messageActionChatReturnYou:"ActionAddUserSelfYou",messageActionChatJoined:"ActionAddUserSelfMega",messageActionChatJoinedYou:"ChannelMegaJoined",messageActionChatAddUser:"ActionAddUser",messageActionChatAddUsers:"ActionAddUser",messageActionChatLeave:"ActionLeftUser",messageActionChatLeaveYou:"YouLeft",messageActionChatDeleteUser:"ActionKickUser",messageActionChatJoinedByLink:"ActionInviteUser",messageActionPinMessage:"Chat.Service.Group.UpdatedPinnedMessage",messageActionContactSignUp:"Chat.Service.PeerJoinedTelegram",messageActionChannelCreate:"ActionCreateChannel",messageActionChannelEditTitle:"Chat.Service.Channel.UpdatedTitle",messageActionChannelEditPhoto:"Chat.Service.Channel.UpdatedPhoto",messageActionChannelEditVideo:"Chat.Service.Channel.UpdatedVideo",messageActionChannelDeletePhoto:"Chat.Service.Channel.RemovedPhoto",messageActionHistoryClear:"HistoryCleared",messageActionDiscussionStarted:"DiscussionStarted",messageActionGiveawayLaunch:"BoostingGiveawayJustStarted",messageActionChannelJoined:"ChannelJoined",messageActionChannelMigrateFrom:"ActionMigrateFromGroup","messageActionPhoneCall.video_in_ok":"ChatList.Service.VideoCall.incoming","messageActionPhoneCall.video_out_ok":"ChatList.Service.VideoCall.outgoing","messageActionPhoneCall.video_missed":"ChatList.Service.VideoCall.Missed","messageActionPhoneCall.video_cancelled":"ChatList.Service.VideoCall.Cancelled","messageActionPhoneCall.in_ok":"ChatList.Service.Call.incoming","messageActionPhoneCall.out_ok":"ChatList.Service.Call.outgoing","messageActionPhoneCall.missed":"ChatList.Service.Call.Missed","messageActionPhoneCall.cancelled":"ChatList.Service.Call.Cancelled","messageActionGroupCall.started":"Chat.Service.VoiceChatStarted.Channel","messageActionGroupCall.started_by":"Chat.Service.VoiceChatStarted","messageActionGroupCall.started_byYou":"Chat.Service.VoiceChatStartedYou","messageActionGroupCall.ended":"Chat.Service.VoiceChatFinished.Channel","messageActionGroupCall.ended_by":"Chat.Service.VoiceChatFinished","messageActionGroupCall.ended_byYou":"Chat.Service.VoiceChatFinishedYou",messageActionBotAllowed:"Chat.Service.BotPermissionAllowed"},la=ee?"Message.Unsupported.Mobile":"Message.Unsupported.Desktop";var ie;(t=>{t.strings=new Map,t.countriesList=[];let e,s;t.requestedServerLanguage=!1,t.isRTL=!1;function r(h){t.isRTL=h}t.setRTL=r;function n(h){t.lastRequestedLangCode=h,t.lastRequestedNormalizedLangCode=h.split("-")[0]}function i(){return s||(s=Promise.all([ye.get("langPack"),t.polyfillPromise]).then(([h])=>h?(t.lastRequestedLangCode||n(h.lang_code),S(h),h):c()).finally(()=>{s=void 0}))}t.getCacheLangPack=i;function o(){if(t.timeFormat==="h12")try{const h=T({hour:"numeric",minute:"numeric",hour12:!0}),g=new Date;g.setHours(0);const v=h.format(g);t.amPmCache.am=v.split(/\s/)[1],g.setHours(12);const D=h.format(g);t.amPmCache.pm=D.split(/\s/)[1]}catch(h){console.error("cannot get am/pm",h),t.amPmCache={am:"AM",pm:"PM"}}}function a(h,g=!!t.timeFormat&&t.timeFormat!==h){t.timeFormat=h,o(),g&&(P.clear(),Array.from(document.querySelectorAll(".i18n")).forEach(D=>{const I=t.weakMap.get(D);I instanceof E&&I.update()}))}t.setTimeFormat=a;function c(){const h=B.langPackCode;return n(h),Promise.all([V(()=>import("./lang-lT3yEsYU.js"),__vite__mapDeps([]),import.meta.url),V(()=>import("./langSign-lcKrqmwM.js"),__vite__mapDeps([]),import.meta.url),V(()=>import("./countries-lRU-UavE.js"),__vite__mapDeps([]),import.meta.url)]).then(([g,v,D])=>{const I=[];d(g.default,I),d(v.default,I);const z={_:"langPackDifference",from_version:0,lang_code:h,strings:I,version:0,local:!0,countries:D.default};return m(z)})}t.loadLocalLangPack=c;function u(h,g){g=!0,t.requestedServerLanguage=!0;const v=C.managers;return Promise.all([v.apiManager.invokeApiCacheable("langpack.getLangPack",{lang_code:h,lang_pack:g?"web":B.langPack}),!g&&v.apiManager.invokeApiCacheable("langpack.getLangPack",{lang_code:h,lang_pack:"android"}),V(()=>import("./lang-lT3yEsYU.js"),__vite__mapDeps([]),import.meta.url),V(()=>import("./langSign-lcKrqmwM.js"),__vite__mapDeps([]),import.meta.url),v.apiManager.invokeApiCacheable("help.getCountriesList",{lang_code:h,hash:0}),t.polyfillPromise])}t.loadLangPack=u;function l(h,g){return C.managers.apiManager.invokeApi("langpack.getStrings",{lang_pack:B.langPack,lang_code:h,keys:g})}t.getStrings=l;function d(h,g=[]){for(const v in h){const D=h[v];typeof D=="string"?g.push({_:"langPackString",key:v,value:D}):g.push({_:"langPackStringPluralized",key:v,...D})}return g}t.formatLocalStrings=d;function f(h,g){return n(h),u(h,g).then(([v,D,I,z,N,oe])=>{let De=[];return[I,z].forEach(mt=>{d(mt.default,De)}),De=De.concat(...[v.strings,D.strings].filter(Boolean)),v.strings=De,v.countries=N,m(v)})}t.getLangPack=f;function m(h){return h.appVersion=B.langPackVersion,ye.set({langPack:h}).then(()=>(S(h),h))}t.saveLangPack=m,t.polyfillPromise=function(){return typeof Intl<"u"&&typeof Intl.PluralRules<"u"?Promise.resolve():V(()=>import("./pluralPolyfill-BfW71bf-.js"),__vite__mapDeps([]),import.meta.url).then(g=>{window.Intl=Object.assign(typeof Intl<"u"?Intl:{},g.default)})}();function S(h){const g=t.lastRequestedLangCode;if(h.lang_code!==g)return;try{e=new Intl.PluralRules(t.lastRequestedNormalizedLangCode)}catch(D){console.error("pluralRules error",D),e=new Intl.PluralRules(t.lastRequestedNormalizedLangCode.split("-",1)[0])}try{e=new Intl.PluralRules(h.lang_code)}catch(D){console.error("pluralRules error",D),e=new Intl.PluralRules(h.lang_code.split("-",1)[0])}t.strings.clear();for(const D of h.strings)t.strings.set(D.key,D);h.countries&&(t.countriesList.length=0,t.countriesList.push(...h.countries.countries),h.countries.countries.forEach(D=>{if(D.name){const I=D.default_name;t.strings.set(I,{_:"langPackString",key:I,value:D.name})}})),t.lastAppliedLangCode!==g&&(t.lastAppliedLangCode&&C.myId&&(C.managers.appReactionsManager.resetAvailableReactions(),C.managers.appUsersManager.indexMyself(),C.managers.dialogsStorage.indexMyDialog()),t.lastAppliedLangCode=g,P.clear(),o(),C.dispatchEvent("language_change",g)),Array.from(document.querySelectorAll(".i18n")).forEach(D=>{const I=t.weakMap.get(D);I&&I.update()})}t.applyLangPack=S;function A(h,g,v,D){const I=g[D===void 0?v.i++:D];Array.isArray(I)?h.push(...I):h.push(I)}function p(h,g,v){if(!v){v={i:0};const N=h.match(/(%|un)\d+/g);N?.length&&(v.i=Math.max(...N.map(oe=>+oe.replace(/\D/g,""))))}const D=[],I=/(\*\*|__)(.+?)\1|(\n)|(\[.+?\]\(.*?\))|un\d|%\d\$.|%./g;let z=0;return h.replace(I,(N,oe,De,mt,Se,Dt,Br)=>{if(Dt>z&&D.push(Br.slice(z,Dt)),oe){let $;switch(oe){case"**":{$=document.createElement("b");break}case"__":{$=document.createElement("i");break}}$.append(...p(De,g,v)),D.push($)}else if(mt)D.push(document.createElement("br"));else if(Se){const $=Se.lastIndexOf("]"),Nr=Se.slice(1,$),pt=Se.slice($+2,Se.length-1);let Y;if(pt&&Xs(pt)){Y=document.createElement("a");const Ft=er(pt);Y.href=Ft.url,Ft.onclick&&Y.setAttribute("onclick",Ft.onclick+"(this)"),Y.target="_blank"}else Y=g[v.i++],Y instanceof DocumentFragment&&(Y=Y.firstChild),typeof Y!="string"&&(Y.textContent="");const hs=p(Nr,g,v);typeof Y=="string"?D.push(...hs):(Y.append(...hs),D.push(Y))}else if(g){const $=N.replace(/\D/g,"");A(D,g,v,!$||Number.isNaN(+$)?void 0:Math.min(g.length-1,+$-1))}return z=Dt+N.length,""}),z!==h.length&&D.push(h.slice(z)),D}t.superFormatter=p;function y(h,g=!1,v){const D=t.strings.get(h);let I;if(D)if(D._==="langPackStringPluralized"&&v?.length){let N=v[0];typeof N=="string"&&(N=+N.replace(/\D/g,""));const oe=e.select(N);I=D[oe+"_value"]||D.other_value}else D._==="langPackString"?I=D.value:I=h;else I=h;const z=p(I,v);return g?z.map(N=>N instanceof Node?N.textContent:N).join(""):z}t.format=y,t.weakMap=new WeakMap;class w{constructor(g){this.element=g?.element||document.createElement("span"),this.element.classList.add("i18n"),this.property=g?.property,t.weakMap.set(this.element,this)}}class _ extends w{constructor(g={}){super({...g,property:g.property??"innerHTML"}),g?.key&&this.update(g)}update(g){if(Nt(this,g),this.property==="innerHTML")this.element.replaceChildren(...y(this.key,!1,this.args)),this.args?.length&&this.element.normalize();else{const v=this.element[this.property],D=y(this.key,!0,this.args);v===void 0?this.element.dataset[this.property]=D:this.element[this.property]=D}}compareAndUpdate(g){if(!(this.key===g.key&&Js(this.args,g.args)))return this.update(g)}}t.IntlElement=_;const P=new Map;function T(h={}){const g=JSON.stringify(h);let v=P.get(g);return v||(v=new Intl.DateTimeFormat(t.lastRequestedNormalizedLangCode+"-u-hc-"+t.timeFormat,h),P.set(g,v)),v}t.getDateTimeFormat=T,t.amPmCache={am:"AM",pm:"PM"};class E extends w{constructor(g){super({...g,property:g.property??"textContent"}),tr(this.element),g?.date&&this.update(g)}update(g){Nt(this,g);let v;if(this.options.hour&&this.options.minute&&Object.keys(this.options).length===2){const D=this.date.getHours();v=("0"+(t.timeFormat==="h12"?D%12||12:D)).slice(-2)+":"+("0"+this.date.getMinutes()).slice(-2),t.timeFormat==="h12"&&(v+=" "+(D<12?t.amPmCache.am:t.amPmCache.pm))}else{const D=T(this.options);v=ht(D.format(this.date))}this.element[this.property]=v}}t.IntlDateElement=E;function O(h,g){return new _({key:h,args:g}).element}t.i18n=O;function b(h){return new _(h).element}t.i18n_=b;function F(h,g,v,D){return new _({element:h,key:g,args:v,property:D}).element}t._i18n=F})(ie||(ie={}));const U=ie,Ie=ie.i18n,ha=ie.i18n_,da=ie._i18n;function kn(t,e){const s=t.slice(0,1);for(let r=1;r<t.length;++r){const n=t.length-1===r;s.push(typeof e=="function"?e(n):e),s.push(t[r])}return s}function fa(t,e=!0,s){const r=kn(t,n=>{const i=n&&e?"AutoDownloadSettings.LastDelimeter":"AutoDownloadSettings.Delimeter";return s?ie.format(i,!0):Ie(i)});return s?r.join(""):r}k&&(k.I18n=ie);function Pn(t){return+t<0}function An(t){return+t>=0}String.prototype.toUserId=function(){return(+this).toUserId()};String.prototype.toChatId=function(){return(+this).toChatId()};String.prototype.toPeerId=function(t){return(+this).toPeerId(t)};String.prototype.isPeerId=function(){return/^[\d-]/.test(this.toString())};Number.prototype.toUserId=function(){return+this};Number.prototype.toChatId=function(){return Math.abs(this)};Number.prototype.toPeerId=function(t){return t===void 0?+this:t?-Math.abs(this):+this};Number.prototype.isPeerId=function(){return!0};[["isUser",An],["isAnyChat",Pn]].forEach(t=>{const e=Array.isArray(t)?t[0]:t,s=Array.isArray(t)?t[1]:t;String.prototype[e]=function(){return s.call(null,this.toString())},Number.prototype[e]=function(){return s.call(null,+this)}});function Tn(...t){const e=t.reduce((n,i)=>n+(i.byteLength||i.length),0),s=new Uint8Array(e);let r=0;return t.forEach(n=>{s.set(n instanceof ArrayBuffer?new Uint8Array(n):n,r),r+=n.byteLength||n.length}),s}Uint8Array.prototype.concat=function(...t){return Tn(this,...t)};Uint8Array.prototype.toJSON=function(){return[...this]};Promise.prototype.finally=Promise.prototype.finally||function(t){const e=s=>Promise.resolve(t()).then(s);return this.then(s=>e(()=>s),s=>e(()=>Promise.reject(s)))};class Ln{constructor(){this.convertPromises={}}init(){this.worker=new Worker(new URL(""+new URL("webp.worker-Yvt9Ei06.js",import.meta.url).href,import.meta.url)),this.worker.addEventListener("message",e=>{const r=e.data.payload,n=this.convertPromises[r.fileName];n&&(r.bytes?n.resolve(r.bytes):n.reject(),delete this.convertPromises[r.fileName])})}postMessage(e){this.init&&(this.init(),this.init=null),this.worker.postMessage(e)}convert(e,s){if(this.convertPromises.hasOwnProperty(e))return this.convertPromises[e];const r=Z();return this.postMessage({type:"convertWebp",payload:{fileName:e,bytes:s}}),this.convertPromises[e]=r}}const sr=new Ln;k.webpWorkerController=sr;class Mn{constructor(){this.prefix="",this.cache={},this.useStorage=!0,K.test&&(this.prefix="t_")}get(e,s=!0){if(this.cache.hasOwnProperty(e)&&s)return this.cache[e];if(this.useStorage){let r;try{r=localStorage.getItem(this.prefix+e)}catch{this.useStorage=!1}if(r!==null)try{r=JSON.parse(r)}catch{}else r=void 0;return r}}set(e,s=!1){for(const r in e)if(e.hasOwnProperty(r)){const n=e[r];if(this.cache[r]=n,this.useStorage&&!s)try{const i=JSON.stringify(n);localStorage.setItem(this.prefix+r,i)}catch{this.useStorage=!1}}}delete(e,s=!1){e=""+e,s||delete this.cache[e];try{localStorage.removeItem(this.prefix+e)}catch{}}clear(){const e=["dc","server_time_offset","xt_instance","user_auth","state_id","k_build"];for(let s=1;s<=5;++s)e.push(`dc${s}_server_salt`),e.push(`dc${s}_auth_key`);for(const s of e)this.delete(s,!0)}toggleStorage(e,s){if(this.useStorage=e,!!s)if(!e)this.clear();else return this.set(this.cache)}}const ut=class ut{constructor(){ut.STORAGES.push(this),de||(this.storage=new Mn)}async proxy(e,...s){return de?Be.getInstance().invoke("localStorageProxy",{type:e,args:s}):(s=Array.prototype.slice.call(s),this.storage[e].apply(this.storage,s))}get(e,s){return this.proxy("get",e,s)}set(e,s){return this.proxy("set",e,s)}delete(e,s){return this.proxy("delete",e,s)}clear(){return this.proxy("clear")}toggleStorage(e,s){return this.proxy("toggleStorage",e,s)}};ut.STORAGES=[];let Vt=ut;const x=new Vt;k.appStorage=x;class In{reload(){try{location.reload()}catch{}}close(){try{window.close()}catch{}}focus(){window.focus()}}const rr=new In;function j(t){if(t===null||typeof t!="object")return t;if(t instanceof Date)return new Date(t.getTime());if(Array.isArray(t))return t.map(n=>j(n));if(ArrayBuffer.isView(t))return t.slice();const e=new t.constructor;for(var s in t)t.hasOwnProperty(s)&&(e[s]=j(t[s]));return e}const Qe=typeof SharedWorker<"u"&&!K.noSharedWorker,Rn=ue?"touchstart":"mousemove";class On extends ge{constructor(){super(),this._isIdle=!0,this.focusPromise=Promise.resolve(),this.focusResolve=()=>{},window.addEventListener("blur",()=>{this.isIdle=!0,window.addEventListener("focus",()=>{this.isIdle=!1},{once:!0})}),window.addEventListener(Rn,()=>{this.isIdle=!1},{once:!0,passive:!0}),this.addEventListener("change",e=>{e?this.focusPromise=new Promise(s=>{this.focusResolve=s}):this.focusResolve()})}getFocusPromise(){return this.focusPromise}get isIdle(){return this._isIdle}set isIdle(e){this._isIdle!==e&&(this._isIdle=e,this.dispatchEvent("change",e))}}const et=new On,xn=5e3,Bn=3e4,Nn=2e4,Un=Qe;class Wn extends ge{constructor(){super(!1),this.log=te("INSTANCE"),this.clearInstance=()=>{this.masterInstance&&!this.deactivated&&(this.log.warn("clear master instance"),x.delete("xt_instance"))},this.checkInstance=async(e=et.isIdle)=>{if(this.deactivated)return;const s=Date.now(),r={id:this.instanceId,idle:e,time:s},[n,i=B.build]=await Promise.all([x.get("xt_instance",!1),x.get("k_build",!1)]);if(i>B.build){this.masterInstance=!1,C.managers.networkerFactory.stopAll(),this.deactivateInstance("version"),dt.toggleStorages(!1,!1);return}else if(Un){x.set({xt_instance:r});return}!e||!n||n.id===this.instanceId||n.time<s-Nn?(x.set({xt_instance:r}),this.masterInstance||(this.masterInstance=!0,C.managers.networkerFactory.startAll(),this.log.warn("now master instance",r)),this.clearDeactivateTimeout()):this.masterInstance&&(this.masterInstance=!1,C.managers.networkerFactory.stopAll(),this.log.warn("now idle instance",r),this.deactivateTimeout||(this.deactivateTimeout=window.setTimeout(()=>this.deactivateInstance("tabs"),Bn)))},this.log=te("INSTANCE"),this.instanceId=zs}get deactivatedReason(){return this.deactivated}start(){if(this.reset(),!this.started){this.started=!0,et.addEventListener("change",this.checkInstance),setInterval(this.checkInstance,xn),this.checkInstance();try{document.documentElement.addEventListener("beforeunload",this.clearInstance)}catch{}}}reset(){this.masterInstance=!1,this.clearDeactivateTimeout(),this.deactivated=void 0}activateInstance(){this.deactivated&&(this.reset(),this.checkInstance(!1),this.dispatchEvent("activated"))}deactivateInstance(e){this.masterInstance||this.deactivated||(this.log.warn("deactivate",e),this.clearDeactivateTimeout(),this.deactivated=e,this.dispatchEvent("deactivated",e))}clearDeactivateTimeout(){this.deactivateTimeout&&(clearTimeout(this.deactivateTimeout),this.deactivateTimeout=0)}}const tt=new Wn;k&&(k.singleInstance=tt);function Vn(t,e){if(t!==void 0)return t=+t.toFixed(0),e?t<Je?t:t%Je:t}function jn(t){return Vn(t,!0)}const Yn=1e4;class nr extends ge{constructor(){super(!1),this.isAvailable=!0,this.isPushEnabled=!1,this.localNotificationsAvailable=!0,this.started=!1,this.settings={},this.isFirefox=navigator.userAgent.toLowerCase().indexOf("firefox")>-1,this.userVisibleOnly=!this.isFirefox,this.log=te("PUSH-API"),this.subscribe=()=>{this.isAvailable&&navigator.serviceWorker.ready.then(e=>{e.pushManager.subscribe({userVisibleOnly:this.userVisibleOnly}).then(s=>{this.isPushEnabled=!0,this.pushSubscriptionNotify("subscribe",s)}).catch(s=>{Notification.permission==="denied"?this.log("Permission for Notifications was denied"):(this.log("Unable to subscribe to push.",s),this.userVisibleOnly||(this.userVisibleOnly=!0,setTimeout(this.subscribe,0)))})})},this.isAliveNotify=()=>{if(!this.isAvailable||tt.deactivatedReason)return;this.settings.baseUrl=(location.href||"").replace(/#.*$/,"");const e={},s={push_action_mute1d:ee?"PushNotification.Action.Mute1d.Mobile":"PushNotification.Action.Mute1d",push_action_settings:ee?"PushNotification.Action.Settings.Mobile":"PushNotification.Action.Settings",push_message_nopreview:"PushNotification.Message.NoPreview"};for(const r in s)e[r]=U.format(s[r],!0);this.serviceMessagePort.invokeVoid("pushPing",{localNotifications:this.localNotificationsAvailable,lang:e,settings:this.settings}),this.isAliveTO=setTimeout(this.isAliveNotify,Yn)},(!("PushManager"in window)||!("Notification"in window)||!("serviceWorker"in navigator))&&(this.log.warn("Push messaging is not supported."),this.isAvailable=!1,this.localNotificationsAvailable=!1),this.isAvailable&&Notification.permission==="denied"&&this.log.warn("The user has blocked notifications.")}start(){this.started||(this.started=!0,this.getSubscription(),this.setUpServiceWorkerChannel())}setLocalNotificationsDisabled(){this.localNotificationsAvailable=!1}getSubscription(){this.isAvailable&&navigator.serviceWorker.ready.then(e=>{e.pushManager.getSubscription().then(s=>{this.isPushEnabled=!!s,this.pushSubscriptionNotify("init",s)}).catch(s=>{this.log.error("Error during getSubscription()",s)})})}unsubscribe(){this.isAvailable&&navigator.serviceWorker.ready.then(e=>{e.pushManager.getSubscription().then(s=>{this.isPushEnabled=!1,s&&(this.pushSubscriptionNotify("unsubscribe",s),setTimeout(()=>{s.unsubscribe().then(r=>{this.isPushEnabled=!1}).catch(r=>{this.log.error("Unsubscription error: ",r)})},3e3))}).catch(s=>{this.log.error("Error thrown while unsubscribing from push messaging.",s)})})}forceUnsubscribe(){this.isAvailable&&navigator.serviceWorker.ready.then(e=>{e.pushManager.getSubscription().then(s=>{this.log.warn("force unsubscribe",s),s&&s.unsubscribe().then(r=>{this.log.warn("force unsubscribe successful",r),this.isPushEnabled=!1}).catch(r=>{this.log.error("Unsubscription error: ",r)})}).catch(s=>{this.log.error("Error thrown while unsubscribing from push messaging.",s)})})}setSettings(e){this.settings=j(e),clearTimeout(this.isAliveTO),this.isAliveNotify()}hidePushNotifications(){this.isAvailable&&this.serviceMessagePort.invokeVoid("notificationsClear",void 0)}setUpServiceWorkerChannel(){this.isAvailable&&(this.serviceMessagePort.addEventListener("pushClick",e=>{if(tt.deactivatedReason){rr.reload();return}this.dispatchEvent("push_notification_click",e)}),navigator.serviceWorker.ready.then(this.isAliveNotify))}pushSubscriptionNotify(e,s){if(s){const r=s.toJSON();if(!r||!r.endpoint||!r.keys||!r.keys.p256dh||!r.keys.auth){this.log.warn("Invalid push subscription",r),this.unsubscribe(),this.isAvailable=!1,this.pushSubscriptionNotify(e);return}this.log.warn("Push",e,r),this.dispatchEvent("push_"+e,{tokenType:10,tokenValue:JSON.stringify(r)})}else this.log.warn("Push",e,!1),this.dispatchEvent("push_"+e,!1)}ignorePushByMid(e,s){this.isAvailable&&this.serviceMessagePort.invokeVoid("shownNotification",e+"_"+jn(s))}}const st=new nr;k&&(k.webPushApiManager=st);const Gn=Object.freeze(Object.defineProperty({__proto__:null,WebPushApiManager:nr,default:st},Symbol.toStringTag,{value:"Module"}));function zn(t){const e=document.createElement("script"),s=new Promise(r=>{e.onload=e.onerror=()=>{r(e)}});return e.src=t,document.body.appendChild(e),s}function Hn(t){const e=Date.now();return t?e/1e3|0:e}class ir{constructor(){this.disabled=K.test||!B.domains.includes(location.hostname)}setAuthorized(e){if(!this.disabled)return x.get("tgme_sync").then(s=>{const r=Hn(!0);if(e&&s?.canRedirect===e&&s.ts+86400>r)return;x.set({tgme_sync:{canRedirect:e,ts:r}});const n=`_websync_?authed=${e?"1":"0"}&version=${encodeURIComponent(B.version+" "+B.suffix)}`,o=["//telegram.me/"+n,"//t.me/"+n].map(a=>zn(a).then(c=>{c.remove()}));return Promise.all(o)})}}const ss=new ir;k&&(k.telegramMeWebManager=ss);const $n=Object.freeze(Object.defineProperty({__proto__:null,TelegramMeWebManager:ir,default:ss},Symbol.toStringTag,{value:"Module"})),rs=typeof RTCPeerConnection<"u"&&!le,qn=rs;let ze;if(!q)ze=!0;else try{ze=+navigator.userAgent.match(/Version\/(.+?) /)[1]>=14}catch{ze=!1}const Kn=ze,Jn="filter"in(document.createElement("canvas").getContext("2d")||{}),Xn=!!navigator?.geolocation?.getCurrentPosition&&!1,Zn=rs,or=document.createElement("canvas").toDataURL("image/webp").startsWith("data:image/webp"),ns=new Set(["image/jpeg","image/png","image/bmp"]);or&&ns.add("image/webp");const is=document.createElement("video"),Qn=!!is.canPlayType("video/webm")&&!q&&!Ce,ar=!!is.canPlayType("video/quicktime")||q||Ce,ei=!!is.canPlayType('video/mp4; codecs="hev1"'),ti=Object.freeze(Object.defineProperty({__proto__:null,IS_H265_SUPPORTED:ei,IS_MOV_SUPPORTED:ar,IS_WEBM_SUPPORTED:Qn},Symbol.toStringTag,{value:"Module"})),os=new Set(["image/gif","video/mp4","video/webm"]);ar&&os.add("video/quicktime");const si=[...ns].concat([...os]),ri=new Set(si),ni=!le&&!1,ii="getDisplayMedia"in(navigator?.mediaDevices||{}),oi=!!navigator?.vibrate,vs=document.createElement("audio"),cr=!!(vs.canPlayType&&vs.canPlayType("audio/ogg;").replace(/no/,""));let ur=!1;try{const t=document.createElement("canvas").getContext("webgl"),e=t.getExtension("WEBGL_debug_renderer_info"),s=e&&t.getParameter(e.UNMASKED_RENDERER_WEBGL)||"";(s.match(/Apple/)&&!s.match(/Apple GPU/)||t.getSupportedExtensions().indexOf("WEBGL_compressed_texture_s3tc_srgb")===-1)&&(ur=!0)}catch{}const ai=ur,ys={CAN_USE_TRANSFERABLES:Kn,IS_APPLE_MX:ai,IS_CALL_SUPPORTED:qn,IS_CANVAS_FILTER_SUPPORTED:Jn,IS_EMOJI_SUPPORTED:Bt,IS_GEOLOCATION_SUPPORTED:Xn,IS_GROUP_CALL_SUPPORTED:Zn,IS_PARALLAX_SUPPORTED:ni,IS_SCREEN_SHARING_SUPPORTED:ii,IS_TOUCH_SUPPORTED:ue,...ti,IS_VIBRATE_SUPPORTED:oi,IS_OPUS_SUPPORTED:cr,IS_SHARED_WORKER_SUPPORTED:Qe,IS_WEBP_SUPPORTED:or,IS_WEBRTC_SUPPORTED:rs,IMAGE_MIME_TYPES_SUPPORTED:ns,MEDIA_MIME_TYPES_SUPPORTED:ri,VIDEO_MIME_TYPES_SUPPORTED:os,...jr};function ci(){const t=document.createElement("input");t.type="time",t.value="15:00",t.style.visibility="hidden",document.body.append(t);const e=t.offsetWidth;return t.remove(),e>110?"h12":"h23"}const ui={8:new Uint8Array(1),16:new Uint16Array(1),32:new Uint32Array(1)};function rt(t){const e=ui[t];return crypto.getRandomValues(e),e[0]}function ga(){return""+rt(32)+rt(32)%16777215}const li=B.version,hi=B.build,Cs={_:"theme",access_hash:"",id:"",settings:[{_:"themeSettings",pFlags:{},base_theme:{_:"baseThemeClassic"},accent_color:3379436,message_colors:[6072403],wallpaper:{_:"wallPaper",pFlags:{default:!0,pattern:!0},access_hash:"",document:void 0,id:"",slug:"pattern",settings:{_:"wallPaperSettings",pFlags:{},intensity:50,background_color:14409147,second_background_color:7054727,third_background_color:14014605,fourth_background_color:8960132}}},{_:"themeSettings",pFlags:{},base_theme:{_:"baseThemeNight"},accent_color:8877281,message_colors:[8877281],wallpaper:{_:"wallPaper",pFlags:{default:!0,pattern:!0,dark:!0},access_hash:"",document:void 0,id:"",slug:"pattern",settings:{_:"wallPaperSettings",pFlags:{},intensity:-50,background_color:16696470,second_background_color:14511289,third_background_color:9842623,fourth_background_color:5200853}}}],slug:"",title:"",emoticon:"ð ",pFlags:{default:!0}},Ss=(t,e,s)=>({...Cs,name:t,settings:{...Cs.settings.find(r=>r.base_theme._===e),highlightingColor:s}}),G={allDialogsLoaded:{},pinnedOrders:{},contactsListCachedTime:0,updates:{},filtersArr:[],maxSeenMsgId:0,stateCreatedTime:Date.now(),recentEmoji:[],recentCustomEmoji:[],topPeersCache:{},recentSearch:[],version:li,build:hi,authState:{_:ee?"authStateSignIn":"authStateSignQr"},hiddenPinnedMessages:{},settings:{messagesTextSize:16,distanceUnit:"kilometers",sendShortcut:"enter",autoDownload:{photo:{contacts:!0,private:!0,groups:!0,channels:!0},video:{contacts:!0,private:!0,groups:!0,channels:!0},file:{contacts:!0,private:!0,groups:!0,channels:!0}},autoDownloadNew:{_:"autoDownloadSettings",file_size_max:3145728,pFlags:{video_preload_large:!0,audio_preload_next:!0},photo_size_max:1048576,video_size_max:15728640,video_upload_maxbitrate:100,small_queue_active_operations_max:0,large_queue_active_operations_max:0},stickers:{suggest:"all",dynamicPackOrder:!0,loop:!0},emoji:{suggest:!0,big:!0},themes:[Ss("day","baseThemeClassic","hsla(86.4, 43.846153%, 45.117647%, .4)"),Ss("night","baseThemeNight","hsla(299.142857, 44.166666%, 37.470588%, .4)")],theme:"system",notifications:{sound:!1},timeFormat:ci(),liteMode:{all:!1,animations:!1,chat:!1,chat_background:!1,chat_spoilers:!1,effects:!1,effects_premiumstickers:!1,effects_reactions:!1,effects_emoji:!1,emoji:!1,emoji_messages:!1,emoji_panel:!1,gif:!1,stickers:!1,stickers_chat:!1,stickers_panel:!1,video:!1}},playbackParams:{volume:1,muted:!1,playbackRate:1,playbackRates:{voice:1,video:1,audio:1},loop:!1,round:!1},keepSigned:!0,chatContextMenuHintWasShown:!1,hideChatJoinRequests:{},stateId:rt(32),notifySettings:{},confirmedWebViews:[],seenTooltips:{storySound:!1},hiddenSimilarChannels:[],appConfig:{}};function We(t,e){t=t.split(" ",1)[0],e=e.split(" ",1)[0];const s=t.split("."),r=e.split(".");for(let n=0;n<s.length;++n){const i=+s[n],o=+r[n];if(i>o)return 1;if(i<o)return-1}return 0}function di(t){return typeof t=="object"&&t!==null}function lr(t,e,s,r,n,i){for(const o in t){const a=i?`${i}.${o}`:o;n?.has(a)||(typeof e[o]!=typeof t[o]?(e[o]=j(t[o]),s?.(r||o)):di(t[o])&&lr(t[o],e[o],s,r||o,n,a))}}function fi(t,e,s){const r=performance.now();return(s||console).warn(Ze(),"start",e),t.then(()=>{(s||console).warn(Ze(),"end",e,performance.now()-r)}),t}function gi(t){return(...e)=>fi(...e,t)}const mi=24*60*60*1e3,Ve=G.version,we=G.build,je=Object.keys(G),Di=["contactsListCachedTime","stateCreatedTime","maxSeenMsgId","filtersArr"];async function pi(){const t=te("STATE-LOADER",es.Error),e=performance.now(),s=gi(t),r=je.map(E=>s(ye.get(E),"state "+E)).concat(s(x.get("user_auth"),"auth"),s(x.get("state_id"),"auth"),s(x.get("k_build"),"auth"),s(x.get("auth_key_fingerprint"),"auth"),s(x.get(`dc${B.baseDcId}_auth_key`),"auth")).concat(s(ye.get("user_auth"),"old auth")),n=await Promise.all(r);t.warn("promises",performance.now()-e);const i=[],o=(E,O)=>{c[E]=O,i.push(E)},a=E=>{i.length=0,c=E,i.push(...Object.keys(c))};let c={};for(let E=0,O=je.length;E<O;++E){const b=je[E],F=n[E];F!==void 0?c[b]=F:o(b,j(G[b]))}n.splice(0,je.length);let u=n.shift();const l=n.shift(),d=n.shift(),f=n.shift(),m=n.shift(),S=n.shift();if(!u&&S){u=S;const E=["dc","server_time_offset","xt_instance"];for(let F=1;F<=5;++F)E.push(`dc${F}_server_salt`),E.push(`dc${F}_auth_key`);const O=await Promise.all(E.map(F=>ye.get(F)));E.push("user_auth"),O.push(typeof u=="number"||typeof u=="string"?{dcID:O[0]||B.baseDcId,date:Date.now()/1e3|0,id:u.toPeerId(!1)}:u);const b={};E.forEach((F,h)=>{b[F]=O[h]}),await x.set(b)}u&&(c.authState={_:"authStateSignedIn"},C.dispatchEvent("user_auth",typeof u=="number"||typeof u=="string"?{dcID:0,date:Date.now()/1e3|0,id:u.toPeerId(!1)}:u));const A=new Set,p=E=>{E.push("authState","stateId");const O=new Map(E.map(F=>[F,c[F]]));c=j(G),O.forEach((F,h)=>{c[h]=F});const b=["chats","dialogs","users"];for(const F of b)A.add(F);a(c)};if(c.stateId!==l&&(l!==void 0&&p([]),await x.set({state_id:c.stateId})),m){const E=m.slice(0,8);f?f!==E&&p([]):p(["settings"]),f!==E&&await x.set({auth_key_fingerprint:E})}const y=Date.now();c.stateCreatedTime+mi<y&&(he&&t("will refresh state",c.stateCreatedTime,y),(O=>{O.forEach(b=>{o(b,j(G[b]))})})(Di));const w=c.settings.autoDownload;if(w?.private!==void 0){const E=["contacts","private","groups","channels"];["photo","video","file"].forEach(b=>{const F=w[b]={};E.forEach(h=>{F[h]=w[h]})}),E.forEach(b=>{delete w[b]}),o("settings",c.settings)}lr(G,c,E=>{o(E,c[E])},void 0,new Set(["settings.themes"]));let P,T;if(c.version!==Ve||c.build!==we){if(c.build<322&&(o("allDialogsLoaded",j(G.allDialogsLoaded)),o("pinnedOrders",j(G.pinnedOrders)),o("filtersArr",j(G.filtersArr)),A.add("dialogs")),We(c.version,"1.7.1")===-1){let E=!1;if(We(c.version,"1.3.0")===-1)E=!0,c.settings.theme=j(G.settings.theme),c.settings.themes=j(G.settings.themes);else if(We(c.version,"1.7.1")===-1){E=!0;const O=c.settings.themes;c.settings.themes=j(G.settings.themes);try{O.forEach(b=>{const F=b.background;if(!F)return;const h=c.settings.themes.find(D=>D.name===b.name);h.settings.highlightingColor=F.highlightingColor;const g=D=>D&&parseInt(D.slice(1),16),v=(F.color||"").split(",").map(g);if(F.color&&!F.slug)h.settings.wallpaper={_:"wallPaperNoFile",id:0,pFlags:{},settings:{_:"wallPaperSettings",pFlags:{}}};else{const D={_:"wallPaper",id:0,access_hash:0,slug:F.slug,document:{},pFlags:{},settings:{_:"wallPaperSettings",pFlags:{}}},I=D.settings;h.settings.wallpaper=D,F.slug&&!F.color?I.pFlags.blur=F.blur||void 0:F.intensity&&(I.intensity=F.intensity,D.pFlags.pattern=!0,D.pFlags.dark=F.intensity<0||void 0)}if(v.length){const D=h.settings.wallpaper.settings;D.background_color=v[0],D.second_background_color=v[1],D.third_background_color=v[2],D.fourth_background_color=v[3]}})}catch(b){console.error("migrating themes error",b)}}E&&o("settings",c.settings)}if(c.build<309&&(c.settings.liteMode.animations=!c.settings.animationsEnabled,c.settings.liteMode.video=!c.settings.autoPlay.videos,c.settings.liteMode.gif=!c.settings.autoPlay.gifs),c.build<312&&typeof c.settings.stickers.suggest=="boolean"&&(c.settings.stickers.suggest=c.settings.stickers.suggest?"all":"none"),c.build<=432){let E=!1;try{for(const O of c.settings.themes)O.settings.highlightingColor||(O.settings.highlightingColor=O.settings.highlightningColor,delete O.settings.highlightningColor,E=!0)}catch{}E&&o("settings",c.settings)}We(c.version,Ve)!==0&&(P=Ve,T=c.version),o("version",Ve),o("build",we)}return d!==we&&(!d||d<we)&&x.set({k_build:we}),C.settings=c.settings,he&&t("state res",c,j(c)),t.warn("total",performance.now()-e),{state:c,resetStorages:A,newVersion:P,oldVersion:T,pushedKeys:i}}let Fi;function Ei(){return Fi??(Fi=pi())}class vi{constructor(){this.sampleRate=48e3,this.tasks=[],this.keepAlive=!1,this.log=te("OPUS",es.Error)}isPlaySupported(){return cr}loadWavWorker(){this.wavWorker||(this.wavWorker=new Worker("waveWorker.min.js"),this.wavWorker.addEventListener("message",e=>{const s=e.data;if(this.log("[WAV] got message:",s),s&&s.page){const r=s.page;this.onTaskEnd(this.tasks.shift(),r)}}))}loadWorker(){this.worker||(this.worker=new Worker("decoderWorker.min.js"),this.worker.addEventListener("message",e=>{const s=e.data;this.log("[DECODER] got message",s),s.type==="done"?(this.wavWorker.postMessage({command:"done"}),s.waveform&&(this.tasks[0].waveform=s.waveform)):this.wavWorker.postMessage({command:"encode",buffers:e.data},q?void 0:s.map(r=>r.buffer))}))}setKeepAlive(e){this.keepAlive=e,this.keepAlive?(this.loadWorker(),this.loadWavWorker()):this.tasks.length||this.terminateWorkers()}onTaskEnd(e,s){s?(clearTimeout(e.timeout),e.callback.resolve({bytes:s,waveform:e.waveform})):e.callback.reject("timeout"),this.tasks.length&&this.executeNewTask(this.tasks[0]),this.terminateWorkers()}terminateWorkers(e=!1){(this.keepAlive||this.tasks.length)&&!e||(this.worker&&(this.worker.terminate(),this.worker=null),this.wavWorker&&(this.wavWorker.terminate(),this.wavWorker=null))}executeNewTask(e){this.worker.postMessage({command:"init",decoderSampleRate:this.sampleRate,outputBufferSampleRate:this.sampleRate}),this.wavWorker.postMessage({command:"init",wavBitDepth:16,wavSampleRate:this.sampleRate}),this.log("[DECODER] send decode"),this.worker.postMessage({command:"decode",pages:e.pages,waveform:e.withWaveform},q?void 0:[e.pages.buffer]),e.timeout=window.setTimeout(()=>{this.log.error("decode timeout"),this.terminateWorkers(!0),this.tasks.length&&(this.loadWorker(),this.loadWavWorker()),this.onTaskEnd(this.tasks.shift())},1e4)}pushDecodeTask(e,s){return new Promise((r,n)=>{const i={pages:e,withWaveform:s,callback:{resolve:r,reject:n},timeout:0};this.loadWorker(),this.loadWavWorker(),this.tasks.push(i)===1&&this.executeNewTask(i)})}async decode(e,s=!1){return this.pushDecodeTask(e,s).then(async r=>{const n=new Blob([r.bytes],{type:"audio/wav"});return{url:await dt.invoke("createObjectURL",n),waveform:r.waveform}})}}const hr=new vi;k.opusDecodeController=hr;class yi extends ts{constructor(){super("CRYPTO"),this.lastIndex=-1}invokeCryptoNew({method:e,args:s,transfer:r}){const n={method:e,args:s},i=this.listeners.invoke;if(i?.length){let a=i[0].callback(n);return!de&&!(a instanceof Promise)&&(a=Promise.resolve(a)),a}const o=e==="aes-encrypt"||e==="aes-decrypt"?this.lastIndex=(this.lastIndex+1)%this.sendPorts.length:0;return this.invoke("invoke",n,void 0,this.sendPorts[o],r)}invokeCrypto(e,...s){return this.invokeCryptoNew({method:e,args:s})}}const He=new yi;k&&(k.cryptoMessagePort=He);function Ci(t){return["image/jpeg","image/png","image/gif","image/svg+xml","image/webp","image/bmp","video/mp4","video/webm","video/quicktime","audio/ogg","audio/mpeg","audio/mp4","audio/wav","application/json","application/pdf"].indexOf(t)===-1?"application/octet-stream":t}function dr(t,e=""){Array.isArray(t)||(t=[t]);const s=Ci(e);return new Blob(t,{type:s})}class Si{constructor(e,s,r){this.mimeType=e,this.size=s,this.saveFileCallback=r,this.bytes=new Uint8Array(s)}async write(e,s){const r=s+e.byteLength;if(r>this.bytes.byteLength){const n=new Uint8Array(r);n.set(this.bytes,0),this.bytes=n}this.bytes.set(e,s)}truncate(){this.bytes=new Uint8Array}trim(e){this.bytes=this.bytes.slice(0,e)}finalize(e=!0){const s=dr(this.bytes,this.mimeType);return e&&this.saveFileCallback&&this.saveFileCallback(s),s}getParts(){return this.bytes}replaceParts(e){this.bytes=e}}const ve=class ve{constructor(e){this.dbName=e,this.useStorage=!0,K.test&&(this.dbName+="_test"),ve.STORAGES.length&&(this.useStorage=ve.STORAGES[0].useStorage),this.openDatabase(),ve.STORAGES.push(this)}openDatabase(){return this.openDbPromise??(this.openDbPromise=caches.open(this.dbName))}delete(e){return this.timeoutOperation(s=>s.delete("/"+e))}deleteAll(){return caches.delete(this.dbName)}get(e){return this.timeoutOperation(s=>s.match("/"+e))}save(e,s){return this.timeoutOperation(r=>r.put("/"+e,s))}getFile(e,s="blob"){return this.get(e).then(r=>{if(!r)throw Xe("NO_ENTRY_FOUND");return r[s]()})}saveFile(e,s){s instanceof Blob||(s=dr(s));const r=new Response(s,{headers:{"Content-Length":""+s.size}});return this.save(e,r).then(()=>s)}timeoutOperation(e){return this.useStorage?new Promise(async(s,r)=>{let n=!1;const i=setTimeout(()=>{r(),n=!0},15e3);try{const o=await this.openDatabase();if(!o)throw this.useStorage=!1,this.openDbPromise=void 0,"no cache?";const a=await e(o);if(n)return;s(a)}catch(o){r(o)}clearTimeout(i)}):Promise.reject(Xe("STORAGE_OFFLINE"))}prepareWriting(e,s,r){return{deferred:Z(),getWriter:()=>new Si(r,s,i=>this.saveFile(e,i).catch(()=>i))}}static toggleStorage(e,s){return Promise.all(this.STORAGES.map(r=>{if(r.useStorage=e,!!s&&!e)return r.deleteAll()}))}};ve.STORAGES=[];let jt=ve;function bs(t,e){return Promise.all([Me.toggleStorage(t,e),jt.toggleStorage(t,e),x.toggleStorage(t,e)]).then(Ke,Ke)}class bi extends ts{constructor(){super("SERVICE"),k&&(k.serviceMessagePort=this)}}const wi=""+new URL("sw-WeADWGhz.js",import.meta.url).href,fr="";function ws(...t){return t.join(fr)}function _i(t,e,s,r){const n=e.split(fr),i=n.length;let o=t;for(let c=0;c<i-1;++c){const u=n[c];o=o[u]??(o[u]={})}const a=n[i-1];s===void 0&&r?delete o[a]:o[a]=s}const ae="_";function ki(t,e){const s="",r=s[s.length-1]||"";let n;switch(t._){case"inputPhotoFileLocation":{n=["photo",s[0],t.id,t.thumb_size].filter(Boolean).join(ae);break}case"inputDocumentFileLocation":{n=["document",s[0],t.id,t.thumb_size].filter(Boolean).join(ae);break}case"inputPeerPhotoFileLocation":n=["peerPhoto",t.photo_id,t.pFlags.big?"big":"small"].join(ae);break;case"inputStickerSetThumb":{n=["stickerSetThumb",t.stickerset.id||t.stickerset.short_name||t.stickerset.emoticon||t.stickerset._,t.thumb_version].join(ae);break}case"inputFileLocation":{n=[t.volume_id,t.local_id].join(ae);break}case"inputWebFileLocation":{n=["webFile",t.url].join(ae);break}case"inputWebFileGeoPointLocation":{const i=t.geo_point;n=["geoPoint",i.lat,i.long,t.w,t.h,t.zoom,t.scale].join(ae);break}default:{console.error("Unrecognized location:",t),n="";break}}return n+(e?.downloadId?"_download":"")+(r&&"."+r)}function Pi(t){return t?._.includes("inputWebFile")}function Ai(t){return Pi(t)?ki(t):t._+(t.id??t.url)}function Ti(t){return{downloaded:0,url:"",type:t}}function Li(t,e){return t+(e!==void 0?"-"+e:"")}function _t(t,e){return t instanceof Promise?t.then(e):e(t)}function _s(t){return typeof t=="number"&&t<Je}class Mi extends Be{constructor(){super(),this.onMirrorTask=e=>{var o;const{name:s,key:r,value:n}=e;if(this.processMirrorTaskMap[s]?.(e),!e.hasOwnProperty("key")){this.mirrors[s]=n;return}const i=(o=this.mirrors)[s]??(o[s]={});_i(i,r,n,!0)},this.mirrors={state:void 0,thumbs:{},stickerThumbs:{},availableReactions:void 0,messages:{},groupedMessages:{},peers:{},avatars:{}},this.processMirrorTaskMap={messages:e=>{var o;const s=e.value;let r,n;if(s)r=s.mid,n=s.grouped_id;else{const[a,c]=e.key.split(".");r=+c;const u=this.mirrors.messages[a]?.[r];if(!u)return;n=u.grouped_id}if(!n)return;const i=(o=this.mirrors.groupedMessages)[n]??(o[n]=new Map);e.value?i.set(r,s):(i.delete(r),i.size||delete this.mirrors.groupedMessages[n])}},this.tabState={chatPeerIds:[],idleStartTime:0},this.log("constructor"),this.registerWorker(),this.registerServiceWorker(),this.registerCryptoWorker(),this.addMultipleEventsListeners({convertWebp:({fileName:e,bytes:s})=>sr.convert(e,s),convertOpus:({fileName:e,bytes:s})=>hr.pushDecodeTask(s,!1).then(r=>r.bytes),event:({name:e,args:s})=>{C.dispatchEventSingle(e,...s)},localStorageProxy:e=>{const s=e;return x[s.type](...s.args)},mirror:this.onMirrorTask}),C.addEventListener("language_change",e=>{C.managers.networkerFactory.setLanguage(e),C.managers.appAttachMenuBotsManager.onLanguageChange()}),window.addEventListener("online",()=>{C.managers.networkerFactory.forceReconnectTimeout()}),C.addEventListener("logging_out",()=>{const e=["cachedFiles","cachedStreamChunks"];Promise.all([bs(!1,!0),x.clear(),Promise.race([ss.setAuthorized(!1),Qt(3e3)]),st.forceUnsubscribe(),Promise.all(e.map(s=>caches.delete(s)))]).finally(()=>{rr.reload()})}),et.addEventListener("change",e=>{this.updateTabStateIdle(e)}),this.updateTabStateIdle(et.isIdle),this.log("Passing environment:",ys),this.invoke("environment",ys)}pingServiceWorkerWithIframe(){if(this.pingServiceWorkerPromise)return this.pingServiceWorkerPromise;const e=this.pingServiceWorkerPromise=Z(),s=document.createElement("iframe");s.hidden=!0;const r=()=>{setTimeout(()=>{this.pingServiceWorkerPromise=void 0},1e4),clearTimeout(n),s.remove(),s.removeEventListener("load",r),s.removeEventListener("error",r),e.resolve()};s.addEventListener("load",r),s.addEventListener("error",r),s.src="ping/"+(Math.random()*4294967295|0)+".nocache",document.body.append(s);const n=window.setTimeout(r,1e3);return e}attachServiceWorker(e){if(this.lastServiceWorker===e){this.log.warn("trying to attach same service worker");return}this.lastServiceWorker&&this.serviceMessagePort.detachPort(this.lastServiceWorker),this.serviceMessagePort.attachSendPort(this.lastServiceWorker=e),this.serviceMessagePort.invokeVoid("hello",void 0)}_registerServiceWorker(){navigator.serviceWorker.register(wi,{type:"module",scope:"./"}).then(e=>{this.log("SW registered",e);const s=new URL(window.location.href),r="swfix",n=+s.searchParams.get(r)||0;if(e.active&&!navigator.serviceWorker.controller){if(n>=3)throw new Error("no controller");return e.unregister().then(()=>{s.searchParams.set(r,""+(n+1)),window.location.href=s.toString()})}n&&(s.searchParams.delete(r),history.pushState(void 0,"",s)),(e.installing||e.waiting||e.active).addEventListener("statechange",a=>{this.log("SW statechange",a)});const o=navigator.serviceWorker.controller||e.installing||e.waiting||e.active;this.attachServiceWorker(o)}).catch(e=>{this.log.error("SW registration failed!",e),this.invokeVoid("serviceWorkerOnline",!1)})}registerServiceWorker(){if(!("serviceWorker"in navigator))return;this.serviceMessagePort=st.serviceMessagePort=new bi;const e=navigator.serviceWorker;this._registerServiceWorker(),e.addEventListener("controllerchange",()=>{this.log.warn("controllerchange");const s=e.controller;this.attachServiceWorker(s),s.addEventListener("error",r=>{this.log.error("controller error:",r)})}),this.serviceMessagePort.attachListenPort(e),this.serviceMessagePort.addMultipleEventsListeners({port:(s,r,n)=>{this.invokeVoid("serviceWorkerPort",void 0,void 0,[n.ports[0]])},hello:(s,r)=>{this.serviceMessagePort.resendLockTask(r)},share:s=>{this.log("will try to share something"),this.share=s}}),e.addEventListener("messageerror",s=>{this.log.error("SW messageerror:",s)})}async registerCryptoWorker(){const e=m=>fetch(m).then(S=>S.text()).then(S=>{const A=location.pathname.split("/");A[A.length-1]="";const p=location.origin+A.join("/");return S=S.replace(/(import (?:.+? from )?['"])\//g,"$1"+p),new Blob([S],{type:"application/javascript"})}),s={construct(m,S){return{url:Ys(S[0]).toString()}}},r=[Worker,typeof SharedWorker<"u"&&SharedWorker].filter(Boolean);r.forEach(m=>window[m.name]=new Proxy(m,s));const n=new Worker(new URL(""+new URL("crypto.worker-BUsbjubc.js",import.meta.url).href,import.meta.url),{type:"module"});r.forEach(m=>window[m.name]=m);const i=n.url,o=m=>new c(m,{type:"module"}),a=m=>this.attachWorkerToPort(m,He,"crypto"),c=Qe?SharedWorker:Worker;He.addEventListener("port",(m,S,A)=>{this.invokeVoid("cryptoPort",void 0,void 0,[A.ports[0]])});const u=o(i);a(u);const l=await e(i);(await this.invoke("createProxyWorkerURLs",{originalUrl:i,blob:l})).slice(1).map(o).forEach(a)}registerWorker(){let e;Qe?e=new SharedWorker(new URL(""+new URL("mtproto.worker-b5o1ZdaL.js",import.meta.url).href,import.meta.url),{type:"module"}):e=new Worker(new URL(""+new URL("mtproto.worker-b5o1ZdaL.js",import.meta.url).href,import.meta.url),{type:"module"}),this.onWorkerFirstMessage(e)}attachWorkerToPort(e,s,r){const n=e.port||e;s.attachPort(n),e.addEventListener("error",i=>{this.log.error(r,"worker error",i)})}onWorkerFirstMessage(e){this.log("set webWorker"),this.attachWorkerToPort(e,this,"mtproto")}loadState(){return Promise.all([Ei().then(e=>(this.newVersion=e.newVersion,this.oldVersion=e.oldVersion,this.mirrors.state=e.state,e))])}sendState(){return this.loadState().then(e=>{const[s]=e;return this.invoke("state",{...s,userId:C.myId.toUserId()}),e})}invokeCrypto(e,...s){return He.invokeCrypto(e,...s)}async toggleStorages(e,s){await bs(e,s),this.invoke("toggleStorages",{enabled:e,clearWrite:s}),this.serviceMessagePort?.invokeVoid("toggleStorages",{enabled:e,clearWrite:s})}async getMirror(e){return this.mirrors[e]}getState(){return this.getMirror("state")}getCacheContext(e,s=Zr,r=Ai(e)){return this.mirrors.thumbs[r]?.[s]||Ti(s)}getStickerCachedThumb(e,s){const r=Li(e,s);return this.mirrors.stickerThumbs[r]}getAvailableReactions(){var e;return(e=this.mirrors).availableReactions||(e.availableReactions=C.managers.appReactionsManager.getAvailableReactions())}getReaction(e){return _t(this.getAvailableReactions(),s=>s.find(r=>r.reaction===e))}getMessageFromStorage(e,s){return e.endsWith("history")&&_s(s)&&(e=this.getGlobalHistoryMessagesStorage()),this.mirrors.messages[e]?.[s]}getGroupsFirstMessage(e){if(!e?.grouped_id)return e;const s=this.mirrors.groupedMessages[e.grouped_id];let r=Number.MAX_SAFE_INTEGER;for(const[n,i]of s)i.mid<r&&(r=i.mid);return s.get(r)}getHistoryMessagesStorage(e){return`${e}_history`}getGlobalHistoryMessagesStorage(){return this.getHistoryMessagesStorage(Gs)}getMessageById(e){if(_s(e))return this.getMessageFromStorage(this.getGlobalHistoryMessagesStorage(),e)}getMessageByPeer(e,s){return e?this.getMessageFromStorage(this.getHistoryMessagesStorage(e),s):this.getMessageById(s)}getPeer(e){return this.mirrors.peers[e]}getUser(e){return this.mirrors.peers[e.toPeerId(!1)]}getChat(e){return this.mirrors.peers[e.toPeerId(!0)]}isForum(e){return!!this.getPeer(e)?.pFlags?.forum}isAvatarCached(e,s){const r=this.mirrors.avatars[e];return s===void 0?!!r:!!(r&&r[s]&&!(r[s]instanceof Promise))}loadAvatar(e,s,r){var i;const n=(i=this.mirrors.avatars)[e]??(i[e]={});return n[r]??(n[r]=C.managers.appAvatarsManager.loadAvatar(e,s,r))}getAppConfig(e){if(e&&(this.appConfig=void 0),!this.appConfig){const s=C.managers.apiManager.getAppConfig().then(r=>(this.appConfig===s&&(this.appConfig=r),r));return this.appConfig=s}return this.appConfig}isPremiumFeaturesHidden(){return _t(this.isPremiumPurchaseBlocked(),e=>e&&!C.premium)}isPremiumPurchaseBlocked(){return _t(this.getAppConfig(),e=>!!e.premium_purchase_blocked)}updateTabState(e,s){this.tabState[e]=s,this.invokeVoid("tabState",this.tabState)}updateTabStateIdle(e){this.updateTabState("idleStartTime",e?Date.now():0)}}const gr=new Mi;k.apiManagerProxy=gr;const dt=gr,Ii={};function Ri(t,e){return new Proxy({},{get:(r,n,i)=>(...o)=>{const a=dt.invoke("manager",{name:t,method:n,args:o},e);return he&&Ii[t]?.has(n)&&console.warn("manager request",t,n,o,e),a}})}function ks(t,e){return new Proxy(t,{get:(s,r,n)=>s[r]??(s[r]=Ri(r,e))})}let _e;function Oi(){return _e||(_e=ks({},!1),_e.acknowledged=ks({},!0),_e)}function mr(t,e,s){return Math.min(s,Math.max(e,t))}function ne(t,e,s){t/=255,e/=255,s/=255;const r=Math.max(t,e,s),n=r-Math.min(t,e,s),i=n&&(r===t?(e-s)/n:r==e?2+(s-t)/n:4+(t-e)/n);return[60*(i<0?i+6:i),r&&n/r,r]}function as(t,e,s){const r=(n,i=(n+t/60)%6)=>Math.round((s-s*e*Math.max(Math.min(i,4-i,1),0))*255);return[r(5),r(3),r(1)]}function Yt(t,e,s,r=1){t/=255,e/=255,s/=255;const n=Math.max(t,e,s),i=Math.min(t,e,s);let o,a;const c=(n+i)/2;if(n===i)o=a=0;else{const u=n-i;switch(a=c>.5?u/(2-n-i):u/(n+i),n){case t:o=(e-s)/u+(e<s?6:0);break;case e:o=(s-t)/u+2;break;case s:o=(t-e)/u+4;break}o/=6}return{h:o*360,s:a*100,l:c*100,a:r}}function Dr(t,e,s,r){t/=360,e/=100,s/=100;let n,i,o;if(e===0)n=i=o=s;else{const a=function(d,f,m){return m<0&&(m+=1),m>1&&(m-=1),m<.16666666666666666?d+(f-d)*6*m:m<.5?f:m<.6666666666666666?d+(f-d)*(.6666666666666666-m)*6:d},c=s<.5?s*(1+e):s+e-s*e,u=2*s-c;n=a(u,c,t+1/3),i=a(u,c,t),o=a(u,c,t-1/3)}return[n,i,o,r].map(a=>Math.round(a*255))}function pr(t){const e=t.slice(5,-1).split(", "),s=+e.pop(),r=e.map(n=>n.endsWith("%")?+n.slice(0,-1):+n);return Dr(r[0],r[1],r[2],s)}function Fr(t){const e=[],s=t[0]==="#"?1:0;if(t.length===5+s&&(t=(s?"#":"")+"0"+t.slice(s)),t.length===3+s)for(let r=s;r<t.length;++r)e.push(parseInt(t[r]+t[r],16));else if(t.length===4+s){for(let r=s;r<t.length-1;++r)e.push(parseInt(t[r]+t[r],16));e.push(parseInt(t[t.length-1],16))}else for(let r=s;r<t.length;r+=2)e.push(parseInt(t.slice(r,r+2),16));return e}function re(t){return Fr(t.slice(0,7))}function ma(t){const e=Fr(t);return Yt(e[0],e[1],e[2],e[3])}function Ae(t){return"#"+t.map(e=>("0"+e.toString(16)).slice(-2)).join("")}function xi(t){return Ae(pr(t))}function Bi(t){return xi(t).slice(0,-2)}function kt(t,e,s){const r=new Array(3);for(let n=0;n<3;++n){const i=t[n],o=e[n];r[n]=Math.floor(o+(i-o)*s)}return r}function Ps(t){return(t[0]*.2126+t[1]*.7152+t[2]*.0722)/255}function Ni(t,e){return t.map((s,r)=>Math.round((s+e[r])/2))}function Ui(t,e,s){const r=ne(...e),n=ne(...s),i=Math.min(1.5*r[1]/t[1],1);return r[0]=Math.min(360,n[0]-r[0]+t[0]),r[1]=Math.min(1,n[1]*t[1]/r[1]),r[2]=Math.min(1,(n[2]/r[2]+i-1)*t[2]/i),r[2]<.3?s:as(...r)}function Wi(t,e,s,r){const n=ne(...s);if(Math.min(Math.abs(n[0]-t[0]),Math.abs(n[0]-t[0]-360))>30)return s;const o=t[1]?Math.min(1.5*n[1]/t[1],1):0;n[0]=Math.min(360,n[0]+e[0]-t[0]),n[1]=t[1]?Math.min(1,n[1]*e[1]/t[1]):0,n[2]=t[2]?Math.min(1,n[2]*(1-o+o*e[2]/t[2])):0;let a=as(...n);const c=Ps(s),u=Ps(a);if(r?c>u:c<u){const f=.4*c/u+.6;a=Vi(a,f)}return a}function Vi(t,e){return t.map(s=>mr(Math.round(s*e),0,255))}function Er(t){const e=(t<0?16777215+t:t).toString(16);return"#"+(e.length>=6?e:"0".repeat(6-e.length)+e)}function Ye(t){return re(Er(t))}function Da(t){return t.settings?[t.settings.background_color,t.settings.second_background_color,t.settings.third_background_color,t.settings.fourth_background_color].filter(Boolean).map(Er).join(","):""}function pa(t,e){const s=t[3];return t.slice(0,3).map((r,n)=>mr(Math.round((s*(r/255)+s*(e[n]/255))*255),0,255))}function Fa(t){const[e,s,r]=t;return .2126*e/255+.7152*s/255+.0722*r/255}function Ea(t){return t>.5?[0,0,0]:[255,255,255]}function va(t,e){const s=t>.5?0:1,r=(t-s+e)/e;return+Math.max(.5,Math.min(.64,r)).toFixed(2)}function vr(t,e,s,r,n=!0){if(t<s&&e<r&&n)return M(t,e);let i=s,o=r;return t/e>s/r?o=e*s/t|0:(i=t*r/e|0,i>s&&(o=o*s/i|0,i=s)),n&&i>=t&&o>=e&&(i=t,o=e),M(i,o)}k.calcImageInBox=vr;class ji{constructor(e=0,s=e){this.width=e,this.height=s}aspect(e,s){return vr(this.width,this.height,e.width,e.height,s)}aspectFitted(e){return this.aspect(e,!0)}aspectCovered(e){return this.aspect(e,!1)}}function M(t,e){return new ji(t,e)}var Yi=(t=>(t[t.mobile=0]="mobile",t[t.medium=1]="medium",t[t.large=2]="large",t))(Yi||{});const Gi=600,zi=1275,Hi=1680,As=M(20,20),Ts=M(36,36),Ls=M(18,18);class $i extends ge{constructor(){super(),this.screenSizes=[{key:0,value:Gi},{key:1,value:zi},{key:2,value:Hi}],this.sizes={handhelds:{regular:M(270,270),webpage:M(270,200),album:M(270,0),esgSticker:M(68,68),animatedSticker:M(180,180),staticSticker:M(180,180),emojiSticker:M(112,112),poll:M(240,0),round:M(240,240),documentName:M(200,0),invoice:M(270,270),extendedInvoice:M(270,270),customEmoji:As,esgCustomEmoji:Ts,emojiStatus:Ls,popupSticker:M(68,68)},desktop:{regular:M(420,340),webpage:M(420,340),album:M(420,0),esgSticker:M(72,72),animatedSticker:M(200,200),staticSticker:M(200,200),emojiSticker:M(112,112),poll:M(330,0),round:M(280,280),documentName:M(240,0),invoice:M(320,320),extendedInvoice:M(420,340),customEmoji:As,esgCustomEmoji:Ts,emojiStatus:Ls,popupSticker:M(80,80)}},this.isMobile=!1,this.handleResize=()=>{const e=window.innerWidth;let s=this.screenSizes[0].key;for(let n=this.screenSizes.length-1;n>=0;--n)if(this.screenSizes[n].value<e){s=(this.screenSizes[n+1]||this.screenSizes[n]).key;break}const r=this.activeScreen;this.activeScreen=s,this.isMobile=this.activeScreen===0,this.active=this.isMobile?this.sizes.handhelds:this.sizes.desktop,r!==s&&r!==void 0&&this.dispatchEvent("changeScreen",r,s),r!==void 0&&this.dispatchEvent("resize")},window.addEventListener("resize",()=>{this.rAF&&window.cancelAnimationFrame(this.rAF),this.rAF=window.requestAnimationFrame(()=>{this.handleResize(),this.rAF=0})}),this.handleResize()}}const yr=new $i;k.mediaSizes=yr;class qi{constructor(){this.resetCache=()=>{this.computedStyle=void 0;const e=this.cache;this.cache={};for(const s in e)this.getProperty(s)},this.cache={},this.nightElement=document.createElement("div"),this.nightElement.className="night",this.nightElement.style.display="none",document.body.append(this.nightElement),C.addEventListener("theme_changed",this.resetCache),yr.addEventListener("resize",this.resetCache)}getProperty(e,s){const r=this.cache[e],n=s?1:0;if(r?.[n])return r[n];this.computedStyle??(this.computedStyle=window.getComputedStyle(document.documentElement)),this.nightComputedStyle??(this.nightComputedStyle=window.getComputedStyle(this.nightElement));const i=(s?this.nightComputedStyle:this.computedStyle).getPropertyValue("--"+e).trim();return this.setPropertyCache(e,i,s)}getPropertyAsColor(e){const s=this.getProperty(e);return s[0]==="#"?s:`rgb(${s})`}getPropertyAsSize(e){const s=this.getProperty(e);let r;return s[s.length-1]==="%"||(s.indexOf("rem")?r=+s.replace("rem","")*16:r=+s.replace("px","")),r}setPropertyCache(e,s,r){var n;return((n=this.cache)[e]??(n[e]=[]))[r?1:0]=s}}const Gt=new qi;k&&(k.customProperties=Gt);const ya={context:void 0,registry:void 0},Ki=(t,e)=>t===e,nt=Symbol("solid-proxy"),Ji=Symbol("solid-track"),it={equals:Ki};let Cr=_r;const se=1,ot=2,Sr={owned:null,cleanups:null,context:null,owner:null},Pt={};var L=null;let At=null,R=null,W=null,Q=null,ft=0;const[Xi,Ca]=ce(!1);function Tt(t,e){const s=R,r=L,n=t.length===0,i=e===void 0?r:e,o=n?Sr:{owned:null,cleanups:null,context:i?i.context:null,owner:i},a=n?t:()=>t(()=>H(()=>gt(o)));L=o,R=null;try{return X(a,!0)}finally{R=s,L=r}}function ce(t,e){e=e?Object.assign({},it,e):it;const s={value:t,observers:null,observerSlots:null,comparator:e.equals||void 0},r=n=>(typeof n=="function"&&(n=n(s.value)),wr(s,n));return[br.bind(s),r]}function Ms(t,e,s){const r=Ne(t,e,!0,se);me(r)}function Zi(t,e,s){const r=Ne(t,e,!1,se);me(r)}function Qi(t,e,s){Cr=ao;const r=Ne(t,e,!1,se);(!s||!s.render)&&(r.user=!0),Q?Q.push(r):me(r)}function Sa(t,e){let s;const r=Ne(()=>{s?s():H(t),s=void 0},void 0,!1,0);return r.user=!0,n=>{s=n,me(r)}}function fe(t,e,s){s=s?Object.assign({},it,s):it;const r=Ne(t,e,!0,0);return r.observers=null,r.observerSlots=null,r.comparator=s.equals||void 0,me(r),br.bind(r)}function eo(t){return t&&typeof t=="object"&&"then"in t}function ba(t,e,s){let r,n,i;arguments.length===2&&typeof e=="object"||arguments.length===1?(r=!0,n=t,i=e||{}):(r=t,n=e,i=s||{});let o=null,a=Pt,c=!1,u="initialValue"in i,l=typeof r=="function"&&fe(r);const d=new Set,[f,m]=(i.storage||ce)(i.initialValue),[S,A]=ce(void 0),[p,y]=ce(void 0,{equals:!1}),[w,_]=ce(u?"ready":"unresolved");function P(b,F,h,g){return o===b&&(o=null,g!==void 0&&(u=!0),(b===a||F===a)&&i.onHydrated&&queueMicrotask(()=>i.onHydrated(g,{value:F})),a=Pt,T(F,h)),F}function T(b,F){X(()=>{F===void 0&&m(()=>b),_(F!==void 0?"errored":u?"ready":"unresolved"),A(F);for(const h of d.keys())h.decrement();d.clear()},!1)}function E(){const b=no,F=f(),h=S();if(h!==void 0&&!o)throw h;return R&&!R.user&&b&&Ms(()=>{p(),o&&(b.resolved||d.has(b)||(b.increment(),d.add(b)))}),F}function O(b=!0){if(b!==!1&&c)return;c=!1;const F=l?l():r;if(F==null||F===!1){P(o,H(f));return}const h=a!==Pt?a:H(()=>n(F,{value:f(),refetching:b}));return eo(h)?(o=h,c=!0,queueMicrotask(()=>c=!1),X(()=>{_(u?"refreshing":"pending"),y()},!1),h.then(g=>P(h,g,void 0,F),g=>P(h,void 0,Pr(g),F))):(P(o,h,void 0,F),h)}return Object.defineProperties(E,{state:{get:()=>w()},error:{get:()=>S()},loading:{get(){const b=w();return b==="pending"||b==="refreshing"}},latest:{get(){if(!u)return E();const b=S();if(b&&!o)throw b;return f()}}}),l?Ms(()=>O(!1)):O(!1),[E,{refetch:O,mutate:m}]}function wa(t){return X(t,!1)}function H(t){if(R===null)return t();const e=R;R=null;try{return t()}finally{R=e}}function _a(t,e,s){const r=Array.isArray(t);let n,i=s&&s.defer;return o=>{let a;if(r){a=Array(t.length);for(let u=0;u<t.length;u++)a[u]=t[u]()}else a=t();if(i){i=!1;return}const c=H(()=>e(a,n,o));return n=a,c}}function ka(t){Qi(()=>H(t))}function to(t){return L===null||(L.cleanups===null?L.cleanups=[t]:L.cleanups.push(t)),t}function Pa(){return R}function Aa(){return L}function Ta(t,e){const s=L,r=R;L=t,R=null;try{return X(e,!0)}catch(n){cs(n)}finally{L=s,R=r}}function so(t){const e=R,s=L;return Promise.resolve().then(()=>{R=e,L=s;let r;return X(t,!1),R=L=null,r?r.done:void 0})}function La(){return[Xi,so]}function Ma(t,e){const s=Symbol("context");return{id:s,Provider:co(s),defaultValue:t}}function Ia(t){return L&&L.context&&L.context[t.id]!==void 0?L.context[t.id]:t.defaultValue}function ro(t){const e=fe(t),s=fe(()=>zt(e()));return s.toArray=()=>{const r=s();return Array.isArray(r)?r:r!=null?[r]:[]},s}let no;function br(){if(this.sources&&this.state)if(this.state===se)me(this);else{const t=W;W=null,X(()=>ct(this),!1),W=t}if(R){const t=this.observers?this.observers.length:0;R.sources?(R.sources.push(this),R.sourceSlots.push(t)):(R.sources=[this],R.sourceSlots=[t]),this.observers?(this.observers.push(R),this.observerSlots.push(R.sources.length-1)):(this.observers=[R],this.observerSlots=[R.sources.length-1])}return this.value}function wr(t,e,s){let r=t.value;return(!t.comparator||!t.comparator(r,e))&&(t.value=e,t.observers&&t.observers.length&&X(()=>{for(let n=0;n<t.observers.length;n+=1){const i=t.observers[n],o=At&&At.running;o&&At.disposed.has(i),(o?!i.tState:!i.state)&&(i.pure?W.push(i):Q.push(i),i.observers&&kr(i)),o||(i.state=se)}if(W.length>1e6)throw W=[],new Error},!1)),e}function me(t){if(!t.fn)return;gt(t);const e=L,s=R,r=ft;R=L=t,io(t,t.value,r),R=s,L=e}function io(t,e,s){let r;try{r=t.fn(e)}catch(n){return t.pure&&(t.state=se,t.owned&&t.owned.forEach(gt),t.owned=null),t.updatedAt=s+1,cs(n)}(!t.updatedAt||t.updatedAt<=s)&&(t.updatedAt!=null&&"observers"in t?wr(t,r):t.value=r,t.updatedAt=s)}function Ne(t,e,s,r=se,n){const i={fn:t,state:r,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:e,owner:L,context:L?L.context:null,pure:s};return L===null||L!==Sr&&(L.owned?L.owned.push(i):L.owned=[i]),i}function at(t){if(t.state===0)return;if(t.state===ot)return ct(t);if(t.suspense&&H(t.suspense.inFallback))return t.suspense.effects.push(t);const e=[t];for(;(t=t.owner)&&(!t.updatedAt||t.updatedAt<ft);)t.state&&e.push(t);for(let s=e.length-1;s>=0;s--)if(t=e[s],t.state===se)me(t);else if(t.state===ot){const r=W;W=null,X(()=>ct(t,e[0]),!1),W=r}}function X(t,e){if(W)return t();let s=!1;e||(W=[]),Q?s=!0:Q=[],ft++;try{const r=t();return oo(s),r}catch(r){s||(Q=null),W=null,cs(r)}}function oo(t){if(W&&(_r(W),W=null),t)return;const e=Q;Q=null,e.length&&X(()=>Cr(e),!1)}function _r(t){for(let e=0;e<t.length;e++)at(t[e])}function ao(t){let e,s=0;for(e=0;e<t.length;e++){const r=t[e];r.user?t[s++]=r:at(r)}for(e=0;e<s;e++)at(t[e])}function ct(t,e){t.state=0;for(let s=0;s<t.sources.length;s+=1){const r=t.sources[s];if(r.sources){const n=r.state;n===se?r!==e&&(!r.updatedAt||r.updatedAt<ft)&&at(r):n===ot&&ct(r,e)}}}function kr(t){for(let e=0;e<t.observers.length;e+=1){const s=t.observers[e];s.state||(s.state=ot,s.pure?W.push(s):Q.push(s),s.observers&&kr(s))}}function gt(t){let e;if(t.sources)for(;t.sources.length;){const s=t.sources.pop(),r=t.sourceSlots.pop(),n=s.observers;if(n&&n.length){const i=n.pop(),o=s.observerSlots.pop();r<n.length&&(i.sourceSlots[o]=r,n[r]=i,s.observerSlots[r]=o)}}if(t.owned){for(e=t.owned.length-1;e>=0;e--)gt(t.owned[e]);t.owned=null}if(t.cleanups){for(e=t.cleanups.length-1;e>=0;e--)t.cleanups[e]();t.cleanups=null}t.state=0}function Pr(t){return t instanceof Error?t:new Error(typeof t=="string"?t:"Unknown error",{cause:t})}function cs(t,e=L){const s=Pr(t);{console.error("solid error",s);return}}function zt(t){if(typeof t=="function"&&!t.length)return zt(t());if(Array.isArray(t)){const e=[];for(let s=0;s<t.length;s++){const r=zt(t[s]);Array.isArray(r)?e.push.apply(e,r):e.push(r)}return e}return t}function co(t,e){return function(r){let n;return Zi(()=>n=H(()=>(L.context={...L.context,[t]:r.value},ro(()=>r.children))),void 0),n}}const uo=Symbol("fallback");function Is(t){for(let e=0;e<t.length;e++)t[e]()}function lo(t,e,s={}){let r=[],n=[],i=[],o=0,a=e.length>1?[]:null;return to(()=>Is(i)),()=>{let c=t()||[],u,l;return c[Ji],H(()=>{let f=c.length,m,S,A,p,y,w,_,P,T;if(f===0)o!==0&&(Is(i),i=[],r=[],n=[],o=0,a&&(a=[])),s.fallback&&(r=[uo],n[0]=Tt(E=>(i[0]=E,s.fallback())),o=1);else if(o===0){for(n=new Array(f),l=0;l<f;l++)r[l]=c[l],n[l]=Tt(d);o=f}else{for(A=new Array(f),p=new Array(f),a&&(y=new Array(f)),w=0,_=Math.min(o,f);w<_&&r[w]===c[w];w++);for(_=o-1,P=f-1;_>=w&&P>=w&&r[_]===c[P];_--,P--)A[P]=n[_],p[P]=i[_],a&&(y[P]=a[_]);for(m=new Map,S=new Array(P+1),l=P;l>=w;l--)T=c[l],u=m.get(T),S[l]=u===void 0?-1:u,m.set(T,l);for(u=w;u<=_;u++)T=r[u],l=m.get(T),l!==void 0&&l!==-1?(A[l]=n[u],p[l]=i[u],a&&(y[l]=a[u]),l=S[l],m.set(T,l)):i[u]();for(l=w;l<f;l++)l in A?(n[l]=A[l],i[l]=p[l],a&&(a[l]=y[l],a[l](l))):n[l]=Tt(d);n=n.slice(0,o=f),r=c.slice(0)}return n});function d(f){if(i[l]=f,a){const[m,S]=ce(l);return a[l]=S,e(c[l],m)}return e(c[l])}}}function Ra(t,e){return H(()=>t(e||{}))}function Ge(){return!0}const Ht={get(t,e,s){return e===nt?s:t.get(e)},has(t,e){return e===nt?!0:t.has(e)},set:Ge,deleteProperty:Ge,getOwnPropertyDescriptor(t,e){return{configurable:!0,enumerable:!0,get(){return t.get(e)},set:Ge,deleteProperty:Ge}},ownKeys(t){return t.keys()}};function Lt(t){return(t=typeof t=="function"?t():t)?t:{}}function ho(){for(let t=0,e=this.length;t<e;++t){const s=this[t]();if(s!==void 0)return s}}function Oa(...t){let e=!1;for(let i=0;i<t.length;i++){const o=t[i];e=e||!!o&&nt in o,t[i]=typeof o=="function"?(e=!0,fe(o)):o}if(e)return new Proxy({get(i){for(let o=t.length-1;o>=0;o--){const a=Lt(t[o])[i];if(a!==void 0)return a}},has(i){for(let o=t.length-1;o>=0;o--)if(i in Lt(t[o]))return!0;return!1},keys(){const i=[];for(let o=0;o<t.length;o++)i.push(...Object.keys(Lt(t[o])));return[...new Set(i)]}},Ht);const s={},r={},n=new Set;for(let i=t.length-1;i>=0;i--){const o=t[i];if(!o)continue;const a=Object.getOwnPropertyNames(o);for(let c=0,u=a.length;c<u;c++){const l=a[c];if(l==="__proto__"||l==="constructor")continue;const d=Object.getOwnPropertyDescriptor(o,l);if(!n.has(l))d.get?(n.add(l),Object.defineProperty(s,l,{enumerable:!0,configurable:!0,get:ho.bind(r[l]=[d.get.bind(o)])})):(d.value!==void 0&&n.add(l),s[l]=d.value);else{const f=r[l];f?d.get?f.push(d.get.bind(o)):d.value!==void 0&&f.push(()=>d.value):s[l]===void 0&&(s[l]=d.value)}}}return s}function xa(t,...e){if(nt in t){const n=new Set(e.length>1?e.flat():e[0]),i=e.map(o=>new Proxy({get(a){return o.includes(a)?t[a]:void 0},has(a){return o.includes(a)&&a in t},keys(){return o.filter(a=>a in t)}},Ht));return i.push(new Proxy({get(o){return n.has(o)?void 0:t[o]},has(o){return n.has(o)?!1:o in t},keys(){return Object.keys(t).filter(o=>!n.has(o))}},Ht)),i}const s={},r=e.map(()=>({}));for(const n of Object.getOwnPropertyNames(t)){const i=Object.getOwnPropertyDescriptor(t,n),o=!i.get&&!i.set&&i.enumerable&&i.writable&&i.configurable;let a=!1,c=0;for(const u of e)u.includes(n)&&(a=!0,o?r[c][n]=i.value:Object.defineProperty(r[c],n,i)),++c;a||(o?s[n]=i.value:Object.defineProperty(s,n,i))}return[...r,s]}const fo=t=>`Stale read from <${t}>.`;function Ba(t){const e="fallback"in t&&{fallback:()=>t.fallback};return fe(lo(()=>t.each,t.children,e||void 0))}function Na(t){const e=t.keyed,s=fe(()=>t.when,void 0,{equals:(r,n)=>e?r===n:!r==!n});return fe(()=>{const r=s();if(r){const n=t.children;return typeof n=="function"&&n.length>0?H(()=>n(e?r:()=>{if(!H(s))throw fo("Show");return t.when})):n}return t.fallback},void 0,void 0)}function Rs(...t){const[e,s]=ce(...t);return(...r)=>r.length===0?e():s(...r)}class go{constructor(){if(de)return;this._width=Rs(),this._height=Rs(),this.viewport=window;const e=()=>{this.setDimensions()};this.viewport.addEventListener("resize",e),e()}setDimensions(){const e=this.viewport;this._width(e.width||e.innerWidth),this._height(e.height||e.innerHeight)}get width(){return this._width()}get height(){return this._height()}}const $t=new go;k&&(k.windowSize=$t);class mo{isEnabled(){return!!(C.settings&&C.settings.liteMode.all)}isAvailable(e){return!!(C.settings&&!C.settings.liteMode.all&&!C.settings.liteMode[e])}}const Ar=new mo;k&&(k.liteMode=Ar);const Os={"primary-color":{rgb:!0,light:!0,lightFilled:!0,dark:!0,darkRgb:!0},"message-out-primary-color":{lightFilled:!0,rgb:!0},"surface-color":{rgb:!0},"danger-color":{rgb:!0,light:!0,dark:!0},"primary-text-color":{rgb:!0},"secondary-text-color":{light:!0,lightFilled:!0},"message-background-color":{light:!0,lightFilled:!0,dark:!0,darkFilled:!0},"message-out-background-color":{light:!0,lightFilled:!0,dark:!0,darkFilled:!0,rgb:!0},"saved-color":{lightFilled:!0},"green-color":{}},Mt={day:{"primary-color":"#3390ec","message-out-primary-color":"#5CA853","message-background-color":"#ffffff","surface-color":"#ffffff","danger-color":"#df3f40","primary-text-color":"#000000","secondary-text-color":"#707579","saved-color":"#359AD4","green-color":"#70b768"},night:{"primary-color":"#8774E1","message-out-primary-color":"#8774E1","message-background-color":"#212121","surface-color":"#212121","danger-color":"#ff595a","primary-text-color":"#ffffff","secondary-text-color":"#aaaaaa","saved-color":"#8774E1","green-color":"#5CC85E"}};class Do{constructor(){C.addEventListener("theme_change",e=>{this.setTheme(typeof e=="object"?e:void 0)}),C.addEventListener("theme_changed",()=>{this.setWorkerThemeParams()})}setWorkerThemeParams(){C.managers.apiManager.setThemeParams({_:"dataJSON",data:JSON.stringify(this.getThemeParamsForWebView())})}get themeColorElem(){return this._themeColorElem!==void 0?this._themeColorElem:this._themeColorElem=document.head.querySelector('[name="theme-color"]')||null}setThemeColor(e=this.themeColor){e||(e=this.isNight()?"#212121":"#ffffff");const s=this.themeColorElem;s&&s.setAttribute("content",e)}setThemeListener(){try{const e=window.matchMedia("(prefers-color-scheme: dark)"),s=()=>{this.systemTheme=e.matches?"night":"day",C.myId?C.dispatchEvent("theme_change"):this.setTheme()};"addEventListener"in e?e.addEventListener("change",s):"addListener"in e&&e.addListener(s),s()}catch{}}applyHighlightingColor(){let e="hsla(85.5319, 36.9171%, 40.402%, .4)";const s=this.getTheme();s.settings?.highlightingColor&&(e=s.settings.highlightingColor);const r=pr(e);document.documentElement.style.setProperty("--message-highlighting-color",e),document.documentElement.style.setProperty("--message-highlighting-color-rgb",r.slice(0,3).join(",")),document.documentElement.style.setProperty("--message-highlighting-alpha",""+r[3]/255),!ue&&e&&(this.themeColor=Bi(e))}_setTheme(e){const s=this.isNight();document.head.querySelector('[name="color-scheme"]')?.setAttribute("content",s?"dark":"light"),document.documentElement.classList.toggle("night",s),this.setThemeColor();const n=this.getTheme();this.applyTheme(n);let i=this.styleElement;i||(i=this.styleElement=document.createElement("style"),document.head.append(i));const o=document.createElement("div");this.applyTheme(C.settings.themes.find(a=>a.name==="night"),o,!0),i.textContent=`.night {${o.style.cssText}}`,this.applyHighlightingColor(),!e&&C.dispatchEventSingle("theme_changed")}setTheme(e){if(!("startViewTransition"in document)||!this.applied){const a=!this.applied,c=this.applied;this.applied=!0,this._setTheme(a),c||this.setWorkerThemeParams();return}Ar.isAvailable("animations")||(e=void 0);const s=!this.isNight();e&&(document.documentElement.classList.add("no-view-transition"),document.documentElement.classList.toggle("reverse",s),document.documentElement.offsetLeft);const r=document.startViewTransition(()=>{this._setTheme()});if(!e)return;const{x:n,y:i}=e,o=Math.hypot(Math.max(n,$t.width-n),Math.max(i,$t.height-i));r.ready.then(()=>{document.documentElement.animate({clipPath:[`circle(0 at ${n}px ${i}px)`,`circle(${o}px at ${n}px ${i}px)`]},{duration:500,easing:"ease-in-out",pseudoElement:`::view-transition-${s?"old":"new"}(root)`,direction:s?"reverse":"normal"})}),r.finished.finally(()=>{document.documentElement.classList.remove("no-view-transition","reverse")})}async switchTheme(e,s){await C.managers.appStateManager.setByKey(ws("settings","theme"),e),C.dispatchEvent("theme_change",s)}isNight(){return this.getTheme().name==="night"}getTheme(e=C.settings.theme==="system"?this.systemTheme:C.settings.theme){return C.settings.themes.find(s=>s.name===e)}bindColorApplier(e){const s=new Set;return{applyAppColor:r=>(s.add(r.name),this.applyAppColor({...r,...e})),finalize:()=>{const r=e.isNight;for(const n in Os)s.has(n)||this.applyAppColor({name:n,hex:Mt[r?"night":"day"][n],...e})}}}applyAppColor({name:e,hex:s,element:r,lightenAlpha:n=.08,darkenAlpha:i=n,mixColor:o,isNight:a=this.isNight(),saveToCache:c}){const u=Os[e],l=re(s),d=Yt(...l);o??(o=re(Mt[a?"night":"day"]["surface-color"]));const f=kt(l,o,n),m={...d,l:d.l-i*100},S=[[e,s],u.rgb&&[e+"-rgb",l.join(",")],u.light&&["light-"+e,`rgba(${l[0]}, ${l[1]}, ${l[2]}, ${n})`],u.lightFilled&&["light-filled-"+e,Ae(f)],u.dark&&["dark-"+e,`hsl(${m.h}, ${m.s}%, ${m.l}%)`]];c??(c=r===document.documentElement),S.filter(Boolean).forEach(([A,p])=>{r.style.setProperty("--"+A,p),c&&Gt.setPropertyCache(A,p,a)})}async applyNewTheme(e){const s=this.isNightTheme(e),r=this.getTheme(),n=C.settings.themes,i=e.settings.find(a=>a.base_theme._===(s?"baseThemeNight":"baseThemeClassic")),o={...e,name:r.name,settings:{...i,highlightingColor:""}};await this.AppBackgroundTab.setBackgroundDocument(i.wallpaper,o.settings),n[n.indexOf(r)]=o,await C.managers.appStateManager.setByKey(ws("settings","themes"),C.settings.themes),C.dispatchEvent("theme_change")}isNightTheme(e){return e.name==="night"||this.isNight()}applyTheme(e,s=document.documentElement,r){const n=this.isNightTheme(e),i=Array.isArray(e.settings)?e.settings.find(T=>T.base_theme._===(n?"baseThemeNight":"baseThemeClassic")):e.settings,o=Mt[n?"night":"day"];let a=ne(...re(o["primary-color"])),c=ne(...Ye(i.accent_color));const u=Wi(a,c,re(o["primary-color"]),!n),l=Ae(u),{applyAppColor:d,finalize:f}=this.bindColorApplier({element:s,isNight:n,saveToCache:r});if(d({name:"primary-color",hex:l,darkenAlpha:.04}),d({name:"saved-color",hex:l,lightenAlpha:.64,mixColor:[255,255,255]}),!i.message_colors?.length)return;const m=n?1:.12,S=re(o["message-out-primary-color"]);a=ne(...S);const A=kt(S,re(o["surface-color"]),m);let y=Ye(i.message_colors[0]);i.message_colors.length>1&&(i.message_colors.slice(1).forEach(T=>{y=Ni(y,Ye(T))}),y=Ui(a,A,y)),c=ne(...y);const _=i.outbox_accent_color!==void 0&&ne(...Ye(i.outbox_accent_color));let P=kt(y,re(o["surface-color"]),m);if(!n){const T=Yt(...P);T.s=Math.min(T.s+(n?8:63),100),P=Dr(T.h,T.s,T.l,T.a).slice(0,3)}d({name:"message-out-background-color",hex:Ae(P),lightenAlpha:m}),d({name:"message-out-primary-color",hex:n?"#ffffff":Ae(_?as(..._):y),mixColor:P}),f()}getThemeParamsForWebView(){const e={bg_color:"surface-color",button_color:"primary-color",button_text_color:"#ffffff",hint_color:"secondary-text-color",link_color:"link-color",secondary_bg_color:"background-color-true",text_color:"primary-text-color",header_bg_color:"surface-color",accent_text_color:"primary-color",section_bg_color:"surface-color",section_header_text_color:"primary-color",subtitle_text_color:"secondary-text-color",destructive_text_color:"danger-color"},s={};for(const r in e){const n=e[r];s[r]=n[0]==="#"?n:Gt.getProperty(n)}return s}}const Tr=new Do;k&&(k.themeController=Tr);class po extends ge{constructor(){super(...arguments),this.overlaysActive=0,this.hasDarkOverlays=0}get isOverlayActive(){return this.overlaysActive>0}set isOverlayActive(e){this.overlaysActive+=e?1:-1,this.dispatchEvent("change",this.isOverlayActive)}get isDarkOverlayActive(){return this.hasDarkOverlays>0}set isDarkOverlayActive(e){this.hasDarkOverlays+=e?1:-1,this.isOverlayActive=e}}const $e=new po;k&&(k.overlayCounter=$e);function Ua(t,e=t.split("?")){return Lr(e?.[1])}function Lr(t){const e={};return t&&t.split("&").forEach(s=>{const[r,n=""]=s.split("=");e[r]=decodeURIComponent(n)}),e}const Fo="onbeforeinstallprompt"in window;let qt;function Eo(){window.addEventListener("beforeinstallprompt",t=>{qt=async()=>{t.prompt();const{outcome:e}=await t.userChoice;e==="accepted"&&(qt=void 0)}})}function Wa(){return qt}const us=["January","February","March","April","May","June","July","August","September","October","November","December"],vo=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],Re=us.slice(),Kt=vo.slice(),Oe=86400;function yo(){const t=U.getDateTimeFormat({weekday:"long"}),e=new Date(Date.UTC(2017,0,2)),s=[];for(let r=0;r<7;++r)s.push(ht(t.format(e))),e.setDate(e.getDate()+1);return s}function Co(){const t=U.getDateTimeFormat({month:"long"}),e=new Date(Date.UTC(2017,0,1)),s=[];for(let r=0;r<12;++r)s.push(ht(t.format(e))),e.setMonth(e.getMonth()+1);return s}function xs(){Re.splice(0,Re.length,...Co()),Kt.splice(0,Kt.length,...yo())}const Bs=t=>{const e=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate())),s=e.getUTCDay()||7;e.setUTCDate(e.getUTCDate()+4-s);const r=new Date(Date.UTC(e.getUTCFullYear(),0,1));return Math.ceil(((e.getTime()-r.getTime())/Oe+1)/7)};function Va(t,e){e||(e=new Date,e.setHours(0,0,0,0));const s={day:"numeric",month:"long"};return t.getFullYear()!==e.getFullYear()&&(s.year="numeric"),new U.IntlDateElement({date:t,options:s}).element}function So(t){const e=new Date,s=e.getTime()/1e3|0,r=t.getTime()/1e3|0,n={};return s-r<Oe&&e.getDate()===t.getDate()?n.hour=n.minute="2-digit":e.getFullYear()!==t.getFullYear()?(n.year=n.day="numeric",n.month="2-digit"):s-r<Oe*7&&Bs(e)===Bs(t)?n.weekday="short":(n.month="short",n.day="numeric"),new U.IntlDateElement({date:t,options:n}).element}const Jt={hour:"2-digit",minute:"2-digit"};function bo(t,e={}){e.combined&&(e.noToday=!0);const s=new Date,r=new Date(t*1e3),n=s.getTime()/1e3,i=e.combined?void 0:wo(r);let o;return n-t<Oe&&s.getDate()===r.getDate()&&!e.noToday?o=Ie(e.capitalize?"Date.Today":"Peer.Status.Today"):n-t<Oe*2&&s.getDate()-1===r.getDate()&&!e.noToday?(o=Ie(e.capitalize?"Yesterday":"Peer.Status.Yesterday"),e.capitalize&&(o.style.textTransform="capitalize")):s.getFullYear()!==r.getFullYear()?o=new U.IntlDateElement({date:r,options:{month:"short",day:"numeric",year:"numeric",...e.combined?Jt:{}}}).element:o=new U.IntlDateElement({date:r,options:{month:"short",day:"numeric",...e.combined?Jt:{}}}).element,{dateEl:o,timeEl:i}}function ja(t,e=!0,s=!1){const{dateEl:r,timeEl:n}=bo(t,{capitalize:e,noToday:s}),i=document.createDocumentFragment();return i.append(r," ",Ie("ScheduleController.at")," ",n),i}function wo(t){return new U.IntlDateElement({date:t,options:Jt}).element}k&&(k.formatDateAccordingToTodayNew=So);const Ya=(t,e={})=>{const s=e.monthAsNumber?".":" ",r=("0"+t.getHours()).slice(-2)+":"+("0"+t.getMinutes()).slice(-2)+(e.noSeconds?"":":"+("0"+t.getSeconds()).slice(-2)),n=t.getFullYear();return(e.leadingZero?("0"+t.getDate()).slice(-2):t.getDate())+s+(e.monthAsNumber?("0"+(t.getMonth()+1)).slice(-2):us[t.getMonth()])+s+(""+n).slice(e.shortYear?2:0)+(e.noTime?"":", "+r)};function Ga(t,e){const s=t>=12&&!(t%12);return Ie(e?s?"BoldYears":"BoldMonths":s?"Years":"Months",[s?t/12:t])}const J=2013,_o=new RegExp("20[0-9]{1,2}"),ls="\\p{L}",ko=new RegExp(`(${ls}{3,})`,"iu"),Po=new RegExp(`(${ls}{3,}) ([0-9]{0,4})`,"iu"),Ao=new RegExp(`([0-9]{0,4}) (${ls}{2,})`,"iu"),To=new RegExp("^([0-9]{1,4})(\\.| |/|\\-)([0-9]{1,4})$","i"),Lo=new RegExp("^([0-9]{1,2})(\\.| |/|\\-)([0-9]{1,2})(\\.| |/|\\-)([0-9]{1,4})$","i"),Mo=[31,29,31,30,31,30,31,31,30,31,30,31];function Io(t,e){const s=t.trim().toLowerCase();if(s.length<3)return;if(["today",U.format("Peer.Status.Today",!0)].some(i=>i.indexOf(s)===0)){const i=new Date,o=i.getFullYear(),a=i.getMonth(),c=i.getDate();i.setFullYear(o,a,c),i.setHours(0,0,0);const u=i.getTime();i.setFullYear(o,a,c+1),i.setHours(0,0,0);const l=i.getTime()-1;e.push({title:U.format("Date.Today",!0),minDate:u,maxDate:l});return}if(["yesterday",U.format("Peer.Status.Yesterday",!0)].some(i=>i.indexOf(s)===0)){const i=new Date,o=i.getFullYear(),a=i.getMonth(),c=i.getDate();i.setFullYear(o,a,c),i.setHours(0,0,0);const u=i.getTime()-864e5;i.setFullYear(o,a,c+1),i.setHours(0,0,0);const l=i.getTime()-86400001;e.push({title:ht(U.format("Yesterday",!0)),minDate:u,maxDate:l});return}const r=Bo(s);if(r>=0){const i=new Date,o=i.getTime(),a=i.getDay(),c=r-a;i.setDate(i.getDate()+c),i.getTime()>o&&i.setTime(i.getTime()-6048e5);const u=i.getFullYear(),l=i.getMonth(),d=i.getDate();i.setFullYear(u,l,d),i.setHours(0,0,0);const f=i.getTime();i.setFullYear(u,l,d+1),i.setHours(0,0,0);const m=i.getTime()-1;e.push({title:Ir(f),minDate:f,maxDate:m});return}let n;if((n=To.exec(s))!==null){const i=n[1],o=n[3],a=parseInt(i),c=parseInt(o);if(a>0&&a<=31){if(c>=J&&a<=12){const u=c,l=a-1;ke(e,l,u);return}else if(c<=12){const u=a-1,l=c-1;It(e,u,l)}}else if(a>=J&&c<=12){const u=a,l=c-1;ke(e,l,u)}return}if((n=Lo.exec(s))!==null){const i=n[1],o=n[3],a=n[5];if(!n[2]===n[4])return;const c=parseInt(i),u=parseInt(o)-1;let l=parseInt(a);l>=10&&l<=99&&(l+=2e3);const d=new Date().getFullYear();if(Rr(c-1,u)&&l>=J&&l<=d){const f=new Date;f.setFullYear(l,u,c),f.setHours(0,0,0);const m=f.getTime();f.setFullYear(l,u,c+1),f.setHours(0,0,0);const S=f.getTime()-1;e.push({title:Mr(m),minDate:m,maxDate:S});return}return}if((n=Po.exec(s))!==null){const i=n[1],o=n[2],a=Rt(i);if(a>=0){const c=+o||new Date().getUTCFullYear();if(c>0&&c<=31){const u=c-1;It(e,u,a);return}else if(c>=J){ke(e,a,c);return}}}if((n=Ao.exec(s))!==null){const i=n[1],o=n[2],a=Rt(o);if(a>=0){const c=+i;if(c>0&&c<=31){const u=c-1;It(e,u,a);return}else c>=J&&ke(e,a,c)}}if((n=ko.exec(s))!==null){const i=n[1],o=Rt(i);if(o>=0){const a=new Date().getFullYear();for(let c=a;c>=J;--c)ke(e,o,c)}}if((n=_o.exec(s))!==null){let i=+n[0];const o=new Date().getFullYear();if(i<J){i=J;for(let a=o;a>=i;a--){const c=new Date;c.setFullYear(a,0,1),c.setHours(0,0,0);const u=c.getTime();c.setFullYear(a+1,0,1),c.setHours(0,0,0);const l=c.getTime()-1;e.push({title:""+a,minDate:u,maxDate:l})}}else if(i<=o){const a=new Date;a.setFullYear(i,0,1),a.setHours(0,0,0);const c=a.getTime();a.setFullYear(i+1,0,1),a.setHours(0,0,0);const u=a.getTime()-1;e.push({title:""+i,minDate:c,maxDate:u})}return}}function ke(t,e,s){const r=new Date().getFullYear(),n=Date.now();if(s>=J&&s<=r){const i=new Date;i.setFullYear(s,e,1),i.setHours(0,0,0);const o=i.getTime();if(o>n)return;i.setMonth(i.getMonth()+1);const a=i.getTime()-1;t.push({title:Ro(o),minDate:o,maxDate:a})}}function It(t,e,s){if(Rr(e,s)){const r=new Date().getFullYear(),n=Date.now();for(let i=r;i>=J;i--){if(s===1&&e===28&&!xo(i))continue;const o=new Date;o.setFullYear(i,s,e+1),o.setHours(0,0,0);const a=o.getTime();if(a>n)continue;o.setFullYear(i,s,e+2),o.setHours(0,0,0);const c=o.getTime()-1;i===r?t.push({title:Oo(a),minDate:a,maxDate:c}):t.push({title:Mr(a),minDate:a,maxDate:c})}}}function Ro(t){const e=new Date(t);return Re[e.getMonth()]+" "+e.getFullYear()}function Oo(t){const e=new Date(t);return Re[e.getMonth()]+" "+e.getDate()}function Mr(t){const e=new Date(t);return("0"+e.getDate()).slice(-2)+"."+("0"+(e.getMonth()+1)).slice(-2)+"."+e.getFullYear()}function Ir(t){const e=new Date(t);return Kt[e.getDay()]}function Rr(t,e){return e>=0&&e<12&&t>=0&&t<Mo[e]}function xo(t){return t%4===0&&t%100!==0||t%400===0}function Rt(t){t=t.toLowerCase();for(let e=0;e<12;e++)if([us[e],Re[e]].some(s=>s.toLowerCase().indexOf(t)===0))return e;return-1}function Bo(t){const e=new Date;if(t.length<=3)return-1;for(let s=0;s<7;s++)if(e.setDate(e.getDate()+1),Ir(e.getTime()).toLowerCase().indexOf(t)===0)return e.getDay();return-1}k.fillTipDates=Io;const Or=ee,xr=ee||!Us&&(!q||Zt)&&!le||Ws<113,No=!Or&&!xr;document.addEventListener("DOMContentLoaded",async()=>{try{B.isMainDomain&&document.referrer&&/(^|\.)(google|bing|duckduckgo|ya|yandex)\./i.test(new URL(document.referrer).host)&&(localStorage.getItem("kz_version")==="Z"||rt(8)>127?(localStorage.setItem("kz_version","Z"),location.href="https://web.telegram.org/a/"):localStorage.setItem("kz_version","K"))}catch{}Xr(),Node.prototype.replaceChildren===void 0&&(Node.prototype.replaceChildren=function(...p){this.textContent="",p&&this.append(...p)}),C.managers=Oi();const t=document.getElementById("manifest");t&&(t.href=`site${Ot&&!Ce?"_apple":""}.webmanifest?v=jw3mK7G9Aq`),tt.start();const e=window.visualViewport||window;let s=!1,r;const n=()=>{let p=(s&&!$e.isOverlayActive?e.height||e.innerHeight:window.innerHeight)*.01;p=+p.toFixed(2),r!==p&&(ue&&r<p&&p-r>1&&Vr(),r=p,document.documentElement.style.setProperty("--vh",`${p}px`))};window.addEventListener("resize",n),n();const i=()=>{const p=document.querySelector(".chat.active");if(!p)return;const y=p.cloneNode(!0);y.querySelectorAll(".chat-input, .chat-background").forEach(E=>E.remove());const w=y.querySelector(".bubbles"),_=w.querySelector(".bubbles-inner");w.replaceChildren(_),w.querySelectorAll("video").forEach(E=>E.muted=!0);const T=document.createElement("div");T.setAttribute("id","printable"),T.append(y),document.body.append(T)},o=()=>{document.getElementById("printable")?.remove()};if(window.addEventListener("beforeprint",i),window.addEventListener("afterprint",o),qe){const p=()=>{s=y===1&&qe&&!$e.isOverlayActive,n(),e!==window&&(s?(window.removeEventListener("resize",n),e.addEventListener("resize",n)):(e.removeEventListener("resize",n),window.addEventListener("resize",n)))};let y;window.onImTabChange=w=>{const _=y!==void 0;y=w,(_||y===1)&&p()},$e.addEventListener("change",()=>{p()})}le&&!Bt&&document.addEventListener("dragstart",p=>{const y=p.target;if(y.tagName==="IMG"&&y.classList.contains("emoji"))return ms(p),!1}),Bt&&document.documentElement.classList.add("native-emoji"),Or?document.documentElement.classList.add("native-scroll"):xr?document.documentElement.classList.add("overlay-scroll"):No&&document.documentElement.classList.add("custom-scroll"),document.addEventListener("dragstart",p=>{if(p.target?.tagName==="IMG")return p.preventDefault(),!1}),document.addEventListener("contextmenu",p=>{p.target.tagName==="IMG"&&!window.appMediaViewer&&ms(p)}),le&&document.documentElement.classList.add("is-firefox","no-backdrop"),ee&&document.documentElement.classList.add("is-mobile"),Ot?(q&&document.documentElement.classList.add("is-safari"),Ce?document.documentElement.classList.add("is-ios"):document.documentElement.classList.add("is-mac")):Ns&&document.documentElement.classList.add("is-android"),ue?document.documentElement.classList.add("is-touch"):document.documentElement.classList.add("no-touch"),Fo&&Eo();const a=performance.now(),c=U.getCacheLangPack(),[u,l]=await Promise.all([dt.sendState().then(([p])=>p),c]);U.setTimeFormat(u.state.settings.timeFormat),C.managers.rootScope.getPremium().then(p=>{C.premium=p}),Tr.setThemeListener(),l.appVersion!==B.langPackVersion?U.getLangPack(l.lang_code):xs(),C.addEventListener("language_change",()=>{xs()});function d(p,y){p.style.opacity="0",y.then(()=>{window.requestAnimationFrame(()=>{p.style.opacity=""})})}console.log("got state, time:",performance.now()-a),l.lang_code==="ar"||l.lang_code==="fa"&&nn&&!1?(document.documentElement.classList.add("is-rtl"),document.documentElement.dir="rtl",document.documentElement.lang=l.lang_code,U.setRTL(!0)):document.documentElement.dir="ltr";let f=u.state.authState;const S=location.hash.split("?"),A=Lr(S[1]??S[0].slice(1));if(A.tgWebAuthToken&&f._!=="authStateSignedIn"){const p={token:A.tgWebAuthToken,dcId:+A.tgWebAuthDcId,userId:A.tgWebAuthUserId.toUserId(),isTest:A.tgWebAuthTest!==void 0&&!!+A.tgWebAuthTest,tgAddr:A.tgaddr};if(p.isTest!==K.test){const y=new URLSearchParams(location.search);+A.tgWebAuthTest?y.set("test","1"):y.delete("test"),location.search=y.toString();return}C.managers.appStateManager.pushToState("authState",f={_:"authStateSignImport",data:p})}if(f._!=="authStateSignedIn"){console.log("Will mount auth page:",f._,Date.now()/1e3);const p=document.getElementById("auth-pages");let y;if(p){y=p.querySelector(".scrollable"),(!ue||Zt)&&y.classList.add("no-scrollbar"),y.style.opacity="0";const _=document.createElement("div");_.classList.add("auth-placeholder"),y.prepend(_),y.append(_.cloneNode())}try{await Promise.all([V(()=>Promise.resolve().then(()=>$n),void 0,import.meta.url),V(()=>Promise.resolve().then(()=>Gn),void 0,import.meta.url)]).then(([_,P])=>{_.default.setAuthorized(!1),P.default.forceUnsubscribe()})}catch{}let w;switch(f._){case"authStateSignIn":w=(await V(()=>import("./pageSignIn-A2hXZJ_t.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8]),import.meta.url)).default.mount();break;case"authStateSignQr":w=(await V(()=>import("./pageSignQR-5yCWN5Ec.js").then(_=>_.a),__vite__mapDeps([7,2,4,1,8]),import.meta.url)).default.mount();break;case"authStateAuthCode":w=(await V(()=>import("./pageAuthCode-SkK5Vakd.js"),__vite__mapDeps([9,2,0,1,3,4,5,6,7,8,10]),import.meta.url)).default.mount(f.sentCode);break;case"authStatePassword":w=(await V(()=>import("./pagePassword-5ZNg9LiA.js"),__vite__mapDeps([11,1,2,4,12,5,13]),import.meta.url)).default.mount();break;case"authStateSignUp":w=(await V(()=>import("./pageSignUp-xIzKK4A-.js"),__vite__mapDeps([14,13,2,5,4,15,6,1]),import.meta.url)).default.mount(f.authCode);break;case"authStateSignImport":w=(await V(()=>import("./pageSignImport-CvcZgwqO.js"),__vite__mapDeps([16,1,2]),import.meta.url)).default.mount(f.data);break}if(y){w&&await w;const _="fonts"in document?Promise.race([Qt(1e3),document.fonts.ready]):Promise.resolve();d(y,_)}}else console.log("Will mount IM page:",Date.now()/1e3),d(document.getElementById("main-columns"),Kr()),(await V(()=>import("./pageIm-3IPlN02F.js"),__vite__mapDeps([17,2]),import.meta.url)).default.mount()});export{Aa as $,B as A,ua as B,wo as C,he as D,ge as E,Ct as F,tr as G,ea as H,ue as I,Nt as J,$o as K,Tt as L,k as M,Gs as N,Oe as O,Zi as P,H as Q,Qi as R,G as S,Zo as T,la as U,Ta as V,ce as W,to as X,ya as Y,fe as Z,V as _,C as a,La as a$,Tr as a0,re as a1,Er as a2,Zr as a3,M as a4,Ho as a5,Pi as a6,Ke as a7,Yr as a8,Ra as a9,Ns as aA,na as aB,Hr as aC,zr as aD,Yo as aE,Go as aF,ta as aG,kt as aH,Yt as aI,Ce as aJ,ni as aK,jn as aL,$r as aM,So as aN,ei as aO,bt as aP,Yi as aQ,Ya as aR,ri as aS,Xo as aT,Qr as aU,Ua as aV,nt as aW,Ji as aX,Pa as aY,wa as aZ,Ms as a_,Na as aa,Oa as ab,Gt as ac,zo as ad,_t as ae,Zt as af,$e as ag,ee as ah,Ot as ai,Ko as aj,Hn as ak,Gr as al,mr as am,bo as an,ha as ao,kn as ap,Xe as aq,es as ar,te as as,Xt as at,$t as au,j as av,rn as aw,Js as ax,ja as ay,q as az,dt as b,xr as b$,_a as b0,xa as b1,Ma as b2,Ia as b3,Ba as b4,ka as b5,et as b6,Rs as b7,Sa as b8,ws as b9,Fr as bA,ji as bB,Uo as bC,Cs as bD,Xn as bE,sn as bF,tn as bG,sa as bH,Wa as bI,Io as bJ,ii as bK,Tn as bL,oi as bM,st as bN,tt as bO,rr as bP,va as bQ,pa as bR,Ea as bS,Fa as bT,jt as bU,We as bV,ss as bW,Qe as bX,Wo as bY,Oi as bZ,fr as b_,ba,Ga as bb,Zn as bc,_n as bd,qn as be,Vn as bf,Jo as bg,le as bh,en as bi,Da as bj,vr as bk,ns as bl,os as bm,ia as bn,Wt as bo,Qo as bp,Sn as bq,Xs as br,Vs as bs,hr as bt,qe as bu,jo as bv,Ds as bw,Bt as bx,Dr as by,Ae as bz,ms as c,ai as c0,Kn as c1,dr as c2,Jn as c3,Li as c4,zs as c5,ki as c6,Us as c7,or as c8,sr as c9,ra as ca,oa as cb,aa as cc,Qs as cd,js as ce,da as d,U as e,x as f,Vr as g,Z as h,Ie as i,Ar as j,xt as k,Kr as l,yr as m,Vo as n,Qn as o,Qt as p,fa as q,ga as r,ye as s,di as t,vn as u,ma as v,er as w,Va as x,qo as y,ca as z};
//# sourceMappingURL=index-LZ-Qulde.js.map
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["./pageSignIn-A2hXZJ_t.js","./putPreloader-fTco7niY.js","./page-AvUSG5kB.js","./countryInputField-ey7HLg59.js","./button-HtigMRvs.js","./wrapEmojiText-8QibrKUG.js","./scrollable-27afSTcq.js","./pageSignQR-5yCWN5Ec.js","./textToSvgURL-Z4O-nL1S.js","./pageAuthCode-SkK5Vakd.js","./codeInputField-CSTf7PZU.js","./pagePassword-5ZNg9LiA.js","./htmlToSpan-p_Z7NKZR.js","./loginPage-o1xRiBw9.js","./pageSignUp-xIzKK4A-.js","./avatar-YjI-LNiq.js","./pageSignImport-CvcZgwqO.js","./pageIm-3IPlN02F.js"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}